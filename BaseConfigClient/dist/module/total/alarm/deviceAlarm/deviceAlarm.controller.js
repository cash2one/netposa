define(["require", "exports", "../../../common/app/main.app", "../../../common/directive/tree/tree-params", "../../../common/services/total.service", "../../totalFactory/doEcharts", "../../../common/services/area.service", "angular", "echarts"], function (require, exports, main_app_1, tree_params_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var echarts = require("echarts");
    var SearchParams = (function () {
        function SearchParams() {
        }
        return SearchParams;
    }());
    var DeviceAlarmController = (function () {
        function DeviceAlarmController($scope, totalService, echartService, areaService, $timeout) {
            var vm = this;
            vm.formatDataList = formatDataList;
            vm.changeTimeBtn = changeTimeBtn;
            vm.showCustomTime = showCustomTime;
            vm.areaCode = '';
            vm.duration = 'THIRY_DAYS';
            vm.startTime = '';
            vm.endTime = '';
            vm.isNoData = true;
            vm.dataPaging = dataPaging;
            vm.currentPage = 1;
            vm.pageSize = 15;
            vm.prePage = prePage;
            vm.nextPage = nextPage;
            function _getSearchParams() {
                var result = new SearchParams();
                result.areaCode = vm.areaCode;
                result.duration = vm.duration;
                result.startTime = vm.startTime;
                result.endTime = vm.endTime;
                result.groupType = "GROUP_BY_CAMERA";
                console.log('传参', result);
                return [result];
            }
            function getDataList() {
                totalService.getAlarmDataList(_getSearchParams()).then(complete);
                function complete(rep) {
                    console.log('设备报警请求成功', rep);
                    if (rep.code === 200 && rep.data) {
                        vm.isNoData = false;
                        formatDataList(rep.data);
                    }
                    else {
                        vm.isNoData = true;
                    }
                }
            }
            getDataList();
            vm.areaTreeDataParams = new tree_params_1.TreeDataParams();
            vm.areaTreeDataParams.treeId = 'areaTreeDeviceAlarm';
            vm.areaTreeDataParams.isDefaultSelected = true;
            vm.areaTreeDataParams.onClick = treeSelectNode;
            function getTreeList() {
                areaService.findListTree().then(complete);
                function complete(result) {
                    $timeout(function () {
                        vm.areaTreeDataParams.treeDatas = result;
                    });
                }
            }
            getTreeList();
            function treeSelectNode(event, treeId, treeNode) {
                vm.areaCode = treeNode.Code;
                vm.areaName = treeNode.Name;
                vm.duration = 'THIRY_DAYS';
                vm.isShowAreaTree = false;
                getDataList();
                $timeout(function () {
                    $scope.$apply();
                });
            }
            function dataPaging(formatData, currentPage) {
                var allData = formatData.length;
                var pageNumber = Math.ceil(allData / vm.pageSize);
                var showArr = [];
                if (currentPage < 1) {
                    currentPage = 1;
                    vm.currentPage = 1;
                }
                else if (currentPage > pageNumber) {
                    currentPage = pageNumber;
                    vm.currentPage = pageNumber;
                }
                for (var i = (currentPage - 1) * vm.pageSize; i < vm.pageSize * currentPage; i++) {
                    if (formatData[i] !== undefined) {
                        showArr.push(formatData[i]);
                    }
                }
                console.log('数据分页', showArr);
                return showArr;
            }
            function prePage() {
                vm.currentPage--;
                getDataList();
            }
            function nextPage() {
                vm.currentPage++;
                getDataList();
            }
            function changeTimeBtn(duration) {
                vm.duration = duration;
                console.log('按钮', vm.duration);
                getDataList();
            }
            function showCustomTime() {
                console.log('自定义时间开始', vm.startTime);
                console.log('自定义时间结束', vm.endTime);
                vm.duration = "CUSTOMIZE";
                getDataList();
            }
            function formatDataList(originalData) {
                var xAxisData = [];
                var allNum = [];
                var onlineNum = [];
                var showArr = dataPaging(originalData.GROUP_BY_CAMERA, vm.currentPage);
                showArr.forEach(function (item, index) {
                    xAxisData.push(item.cameraName);
                    allNum.push(item.allAlarmNum);
                    onlineNum.push(item.validAlarmNum);
                });
                var formatData = {
                    seriesNameOne: '全部',
                    seriesNameTwo: '有效',
                    gridLeft: '5%',
                    gridRight: '5%',
                    xAxisName: '',
                    yAxisName: '',
                    colorTwo: ['#8cdcff'],
                    colorOne: ['#40c4ff'],
                    xAxisData: xAxisData,
                    allNum: allNum,
                    onlineNum: onlineNum
                };
                echartService.drawEchart(echartService.echartPileBarOption(formatData), 'alarm-3');
            }
        }
        DeviceAlarmController.$inject = ['$scope', 'totalService', 'echartService', 'areaService', '$timeout'];
        return DeviceAlarmController;
    }());
    main_app_1.app.controller('deviceAlarmController', DeviceAlarmController);
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tb2R1bGUvdG90YWwvYWxhcm0vZGV2aWNlQWxhcm0vZGV2aWNlQWxhcm0uY29udHJvbGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7SUFzQkEsSUFBSSxPQUFPLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBRWpDO1FBQUE7UUFNQSxDQUFDO1FBQUQsbUJBQUM7SUFBRCxDQU5BLEFBTUMsSUFBQTtJQUVEO1FBNENJLCtCQUFZLE1BQVcsRUFBRSxZQUEyQixFQUFFLGFBQTRCLEVBQUMsV0FBd0IsRUFBRSxRQUFZO1lBQ3JILElBQUksRUFBRSxHQUFHLElBQUksQ0FBQztZQUVkLEVBQUUsQ0FBQyxjQUFjLEdBQUcsY0FBYyxDQUFDO1lBRW5DLEVBQUUsQ0FBQyxhQUFhLEdBQUcsYUFBYSxDQUFDO1lBQ2pDLEVBQUUsQ0FBQyxjQUFjLEdBQUcsY0FBYyxDQUFDO1lBR25DLEVBQUUsQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDO1lBQ2pCLEVBQUUsQ0FBQyxRQUFRLEdBQUcsWUFBWSxDQUFDO1lBQzNCLEVBQUUsQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO1lBQ2xCLEVBQUUsQ0FBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1lBQ2hCLEVBQUUsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO1lBRW5CLEVBQUUsQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDO1lBQzNCLEVBQUUsQ0FBQyxXQUFXLEdBQUcsQ0FBQyxDQUFDO1lBQ25CLEVBQUUsQ0FBQyxRQUFRLEdBQUUsRUFBRSxDQUFDO1lBRWhCLEVBQUUsQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1lBQ3JCLEVBQUUsQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1lBR3ZCO2dCQUNJLElBQUksTUFBTSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7Z0JBRWhDLE1BQU0sQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQztnQkFDOUIsTUFBTSxDQUFDLFFBQVEsR0FBRyxFQUFF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NEJBQUM7S0F2TkQsQUF1TkMsSUFBQTtJQUVELGNBQUcsQ0FBQyxVQUFVLENBQUMsdUJBQXVCLEVBQUUscUJBQXFCLENBQUMsQ0FBQyIsImZpbGUiOiJtb2R1bGUvdG90YWwvYWxhcm0vZGV2aWNlQWxhcm0vZGV2aWNlQWxhcm0uY29udHJvbGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHRqIG9uIDIwMTcvNC8yMS5cclxuICovXHJcblxyXG5pbXBvcnQge2FwcH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9hcHAvbWFpbi5hcHBcIjtcclxuXHJcbmltcG9ydCB7SVRvdGFsU2VydmljZX0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9zZXJ2aWNlcy90b3RhbC5zZXJ2aWNlXCJcclxuaW1wb3J0IFwiLi4vLi4vLi4vY29tbW9uL3NlcnZpY2VzL3RvdGFsLnNlcnZpY2VcIlxyXG5cclxuaW1wb3J0IHtJRWNoYXJ0U2VydmljZX0gZnJvbSBcIi4uLy4uL3RvdGFsRmFjdG9yeS9kb0VjaGFydHNcIlxyXG5pbXBvcnQgXCIuLi8uLi90b3RhbEZhY3RvcnkvZG9FY2hhcnRzXCJcclxuaW1wb3J0IHtSZXNwb25zZVJlc3VsdH0gZnJvbSBcIi4uLy4uLy4uLy4uL2NvcmUvcGFyYW1zL3Jlc3VsdC9SZXNwb25zZVJlc3VsdFwiO1xyXG5pbXBvcnQge0FsYXJtUmVzcG9uc2UsQWxhcm1Hcm91cEJ5Q2FtZXJhfSBmcm9tIFwiLi4vLi4vdG90YWxGYWN0b3J5L3RvdGFsUmVzcG9uc2VcIlxyXG5cclxuaW1wb3J0IHtJVHJlZURhdGFQYXJhbXMsIFRyZWVEYXRhUGFyYW1zfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2RpcmVjdGl2ZS90cmVlL3RyZWUtcGFyYW1zXCI7XHJcbmltcG9ydCB7QXJlYUV4fSBmcm9tIFwiLi4vLi4vLi4vLi4vY29yZS9lbnRpdHkvZXgvQXJlYUV4XCI7XHJcbmltcG9ydCB7SUFyZWFTZXJ2aWNlfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL3NlcnZpY2VzL2FyZWEuc2VydmljZVwiO1xyXG5pbXBvcnQgJy4uLy4uLy4uL2NvbW1vbi9zZXJ2aWNlcy9hcmVhLnNlcnZpY2UnO1xyXG5cclxuaW1wb3J0IFwiYW5ndWxhclwiO1xyXG5pbXBvcnQgXCJlY2hhcnRzXCI7XHJcbmRlY2xhcmUgbGV0IHJlcXVpcmU6IGFueTtcclxubGV0IGVjaGFydHMgPSByZXF1aXJlKFwiZWNoYXJ0c1wiKTtcclxuXHJcbmNsYXNzIFNlYXJjaFBhcmFtcyB7XHJcbiAgICBhcmVhQ29kZTogc3RyaW5nO1xyXG4gICAgZHVyYXRpb246IHN0cmluZztcclxuICAgIHN0YXJ0VGltZTpzdHJpbmc7XHJcbiAgICBlbmRUaW1lOnN0cmluZztcclxuICAgIGdyb3VwVHlwZTpzdHJpbmc7XHJcbn1cclxuXHJcbmNsYXNzIERldmljZUFsYXJtQ29udHJvbGxlciB7XHJcbiAgICBzdGF0aWMgJGluamVjdCA9IFsnJHNjb3BlJywgJ3RvdGFsU2VydmljZScsJ2VjaGFydFNlcnZpY2UnLCdhcmVhU2VydmljZScsJyR0aW1lb3V0J107XHJcblxyXG4gICAgLy/moLzlvI/ljJbmlbDmja5cclxuICAgIGZvcm1hdERhdGFMaXN0OkZ1bmN0aW9uO1xyXG5cclxuICAgIC8v5YiH5o2i5LiN5ZCM5pe26Ze05oyJ6ZKuXHJcbiAgICBjaGFuZ2VUaW1lQnRuOkZ1bmN0aW9uO1xyXG5cclxuICAgIC8v5bGV56S66Ieq5a6a5LmJ5pe26Ze05q615pWw5o2uXHJcbiAgICBzaG93Q3VzdG9tVGltZTpGdW5jdGlvbjtcclxuXHJcbiAgICAvL+WMuuWfn+agkVxyXG4gICAgYXJlYVRyZWVEYXRhUGFyYW1zOklUcmVlRGF0YVBhcmFtczxBcmVhRXg+O1xyXG4gICAgLy/lsZXnpLrljLrln5/moJFcclxuICAgIGlzU2hvd0FyZWFUcmVlOmJvb2xlYW47XHJcblxyXG4gICAgLy/lvIDlp4vml7bpl7RcclxuICAgIHN0YXJ0VGltZTpzdHJpbmc7XHJcbiAgICAvL+e7k+adn+aXtumXtFxyXG4gICAgZW5kVGltZTpzdHJpbmc7XHJcbiAgICAvL+WMuuWfn+WQjVxyXG4gICAgYXJlYU5hbWU6c3RyaW5nO1xyXG4gICAgLy/ljLrln59jb2RlXHJcbiAgICBhcmVhQ29kZTpzdHJpbmc7XHJcbiAgICAvL+aXtumXtOautVxyXG4gICAgZHVyYXRpb246c3RyaW5nO1xyXG5cclxuICAgIC8v5peg5pWw5o2u5pe25bGV56S6XHJcbiAgICBpc05vRGF0YTpib29sZWFuO1xyXG5cclxuICAgIC8vIOaVsOaNruWIhumhtVxyXG4gICAgZGF0YVBhZ2luZzpGdW5jdGlvbjtcclxuICAgIC8v5b2T5YmN6aG15pWwXHJcbiAgICBjdXJyZW50UGFnZTpudW1iZXI7XHJcbiAgICAvL+avj+mhteWxleekuuaVsFxyXG4gICAgcGFnZVNpemU6bnVtYmVyO1xyXG5cclxuICAgIC8v5LiK5LiA5LiqXHJcbiAgICBwcmVQYWdlOiBGdW5jdGlvbjtcclxuXHJcbiAgICAvL+S4i+S4gOS4qlxyXG4gICAgbmV4dFBhZ2U6IEZ1bmN0aW9uO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCRzY29wZTogYW55LCB0b3RhbFNlcnZpY2U6IElUb3RhbFNlcnZpY2UsIGVjaGFydFNlcnZpY2U6SUVjaGFydFNlcnZpY2UsYXJlYVNlcnZpY2U6SUFyZWFTZXJ2aWNlLCAkdGltZW91dDphbnkpIHtcclxuICAgICAgICBsZXQgdm0gPSB0aGlzO1xyXG5cclxuICAgICAgICB2bS5mb3JtYXREYXRhTGlzdCA9IGZvcm1hdERhdGFMaXN0O1xyXG5cclxuICAgICAgICB2bS5jaGFuZ2VUaW1lQnRuID0gY2hhbmdlVGltZUJ0bjtcclxuICAgICAgICB2bS5zaG93Q3VzdG9tVGltZSA9IHNob3dDdXN0b21UaW1lO1xyXG5cclxuICAgICAgICAvL+m7mOiupOWAvFxyXG4gICAgICAgIHZtLmFyZWFDb2RlID0gJyc7XHJcbiAgICAgICAgdm0uZHVyYXRpb24gPSAnVEhJUllfREFZUyc7XHJcbiAgICAgICAgdm0uc3RhcnRUaW1lID0gJyc7XHJcbiAgICAgICAgdm0uZW5kVGltZSA9ICcnO1xyXG4gICAgICAgIHZtLmlzTm9EYXRhID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdm0uZGF0YVBhZ2luZyA9IGRhdGFQYWdpbmc7XHJcbiAgICAgICAgdm0uY3VycmVudFBhZ2UgPSAxO1xyXG4gICAgICAgIHZtLnBhZ2VTaXplID0xNTtcclxuXHJcbiAgICAgICAgdm0ucHJlUGFnZSA9IHByZVBhZ2U7XHJcbiAgICAgICAgdm0ubmV4dFBhZ2UgPSBuZXh0UGFnZTtcclxuXHJcbiAgICAgICAgLy8g5ZCR5ZCO5Y+w5Lyg55qE5Y+C5pWwXHJcbiAgICAgICAgZnVuY3Rpb24gX2dldFNlYXJjaFBhcmFtcygpOkFycmF5PFNlYXJjaFBhcmFtcz57XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBuZXcgU2VhcmNoUGFyYW1zKCk7XHJcblxyXG4gICAgICAgICAgICByZXN1bHQuYXJlYUNvZGUgPSB2bS5hcmVhQ29kZTtcclxuICAgICAgICAgICAgcmVzdWx0LmR1cmF0aW9uID0gdm0uZHVyYXRpb247XHJcbiAgICAgICAgICAgIHJlc3VsdC5zdGFydFRpbWUgPSB2bS5zdGFydFRpbWU7XHJcbiAgICAgICAgICAgIHJlc3VsdC5lbmRUaW1lID0gdm0uZW5kVGltZTtcclxuICAgICAgICAgICAgcmVzdWx0Lmdyb3VwVHlwZSA9IFwiR1JPVVBfQllfQ0FNRVJBXCI7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfkvKDlj4InLHJlc3VsdCk7XHJcbiAgICAgICAgICAgIHJldHVybiBbcmVzdWx0XTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8v6I635Y+W5pWw5o2u5YiX6KGoXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0RGF0YUxpc3QoKXtcclxuICAgICAgICAgICAgdG90YWxTZXJ2aWNlLmdldEFsYXJtRGF0YUxpc3QoX2dldFNlYXJjaFBhcmFtcygpKS50aGVuKGNvbXBsZXRlKTtcclxuICAgICAgICAgICAgZnVuY3Rpb24gY29tcGxldGUocmVwOlJlc3BvbnNlUmVzdWx0PEFsYXJtUmVzcG9uc2U+KXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCforr7lpIfmiqXorabor7fmsYLmiJDlip8nLHJlcCk7XHJcbiAgICAgICAgICAgICAgICBpZihyZXAuY29kZSA9PT0gMjAwICYmIHJlcC5kYXRhKXtcclxuICAgICAgICAgICAgICAgICAgICB2bS5pc05vRGF0YSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdERhdGFMaXN0KHJlcC5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmlzTm9EYXRhID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZ2V0RGF0YUxpc3QoKTtcclxuXHJcbiAgICAgICAgLy8g5Yid5aeL5YyW5Yy65Z+f5qCRXHJcbiAgICAgICAgdm0uYXJlYVRyZWVEYXRhUGFyYW1zID0gbmV3IFRyZWVEYXRhUGFyYW1zPEFyZWFFeD4oKTtcclxuICAgICAgICB2bS5hcmVhVHJlZURhdGFQYXJhbXMudHJlZUlkID0gJ2FyZWFUcmVlRGV2aWNlQWxhcm0nO1xyXG4gICAgICAgIHZtLmFyZWFUcmVlRGF0YVBhcmFtcy5pc0RlZmF1bHRTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgdm0uYXJlYVRyZWVEYXRhUGFyYW1zLm9uQ2xpY2sgPSB0cmVlU2VsZWN0Tm9kZTtcclxuXHJcbiAgICAgICAgLy8g6I635Y+W5Yy65Z+f5qCR5pWw5o2uXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0VHJlZUxpc3QoKXtcclxuICAgICAgICAgICAgYXJlYVNlcnZpY2UuZmluZExpc3RUcmVlKCkudGhlbihjb21wbGV0ZSk7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXBsZXRlKHJlc3VsdDogQXJyYXk8QXJlYUV4Pikge1xyXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmFyZWFUcmVlRGF0YVBhcmFtcy50cmVlRGF0YXMgPSByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZ2V0VHJlZUxpc3QoKTtcclxuXHJcbiAgICAgICAgLy8g54K55Ye75b2T5YmN6IqC54K55pe26I635Y+W6IqC54K55L+h5oGvXHJcbiAgICAgICAgZnVuY3Rpb24gdHJlZVNlbGVjdE5vZGUoZXZlbnQ6IE1vdXNlRXZlbnQsIHRyZWVJZDogc3RyaW5nLCB0cmVlTm9kZTogYW55KSB7XHJcbiAgICAgICAgICAgIC8v5Yy65Z+fQ29kZVxyXG4gICAgICAgICAgICB2bS5hcmVhQ29kZSA9IHRyZWVOb2RlLkNvZGU7XHJcbiAgICAgICAgICAgIC8v5Yy65Z+f5ZCNXHJcbiAgICAgICAgICAgIHZtLmFyZWFOYW1lID0gdHJlZU5vZGUuTmFtZTtcclxuICAgICAgICAgICAgdm0uZHVyYXRpb24gPSAnVEhJUllfREFZUyc7XHJcbiAgICAgICAgICAgIHZtLmlzU2hvd0FyZWFUcmVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGdldERhdGFMaXN0KCk7XHJcbiAgICAgICAgICAgIC8v5Li65LqG6Kem5Y+R6ISP5qOA5p+lIOabtOaWsOinhuWbvlxyXG4gICAgICAgICAgICAkdGltZW91dCgoKT0+IHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDmlbDmja7liIbpobUg5qC55o2u6aG15pWw5bGV56S65a+55bqU5pWw5o2uXHJcbiAgICAgICAgZnVuY3Rpb24gZGF0YVBhZ2luZyhmb3JtYXREYXRhOkFycmF5PGFueT4sY3VycmVudFBhZ2U6bnVtYmVyKXtcclxuICAgICAgICAgICAgLy/mgLvmlbDmja7mnaHmlbBcclxuICAgICAgICAgICAgbGV0IGFsbERhdGE6bnVtYmVyID0gZm9ybWF0RGF0YS5sZW5ndGg7XHJcbiAgICAgICAgICAgIC8v5pWw5o2u5oC76aG15pWwXHJcbiAgICAgICAgICAgIGxldCBwYWdlTnVtYmVyOm51bWJlciA9IE1hdGguY2VpbChhbGxEYXRhIC8gdm0ucGFnZVNpemUpO1xyXG4gICAgICAgICAgICAvL+avj+asoeWxleekuueahOaVsOaNrlxyXG4gICAgICAgICAgICBsZXQgc2hvd0FycjpBcnJheTxhbnk+ID0gW107XHJcblxyXG4gICAgICAgICAgICBpZihjdXJyZW50UGFnZSA8IDEpe1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFBhZ2UgPSAxO1xyXG4gICAgICAgICAgICAgICAgdm0uY3VycmVudFBhZ2UgPSAxO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYoY3VycmVudFBhZ2UgPiBwYWdlTnVtYmVyKXtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYWdlID0gcGFnZU51bWJlcjtcclxuICAgICAgICAgICAgICAgIHZtLmN1cnJlbnRQYWdlID0gcGFnZU51bWJlcjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IChjdXJyZW50UGFnZSAtIDEpICogdm0ucGFnZVNpemU7IGkgPCB2bS5wYWdlU2l6ZSAqIGN1cnJlbnRQYWdlOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmKGZvcm1hdERhdGFbaV0gIT09IHVuZGVmaW5lZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hvd0Fyci5wdXNoKGZvcm1hdERhdGFbaV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn5pWw5o2u5YiG6aG1JyxzaG93QXJyKVxyXG4gICAgICAgICAgICByZXR1cm4gc2hvd0FycjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIOiuvuWkh+aKpeitpuaVsOaNruWIh+aNoiDkuIrkuIDpobVcclxuICAgICAgICBmdW5jdGlvbiBwcmVQYWdlKCl7XHJcbiAgICAgICAgICAgIHZtLmN1cnJlbnRQYWdlLS07XHJcbiAgICAgICAgICAgIGdldERhdGFMaXN0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDorr7lpIfmiqXorabmlbDmja7liIfmjaIg5LiL5LiA6aG1XHJcbiAgICAgICAgZnVuY3Rpb24gbmV4dFBhZ2UoKXtcclxuICAgICAgICAgICAgdm0uY3VycmVudFBhZ2UrKztcclxuICAgICAgICAgICAgZ2V0RGF0YUxpc3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8v54K55Ye75LiN5ZCM5pe26Ze05q615oyJ6ZKuXHJcbiAgICAgICAgZnVuY3Rpb24gY2hhbmdlVGltZUJ0bihkdXJhdGlvbjpzdHJpbmcpe1xyXG4gICAgICAgICAgICB2bS5kdXJhdGlvbiA9IGR1cmF0aW9uO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn5oyJ6ZKuJyx2bS5kdXJhdGlvbik7XHJcbiAgICAgICAgICAgIGdldERhdGFMaXN0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL+iHquWumuS5ieaXtumXtFxyXG4gICAgICAgIGZ1bmN0aW9uIHNob3dDdXN0b21UaW1lKCl7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfoh6rlrprkuYnml7bpl7TlvIDlp4snLHZtLnN0YXJ0VGltZSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfoh6rlrprkuYnml7bpl7Tnu5PmnZ8nLHZtLmVuZFRpbWUpO1xyXG4gICAgICAgICAgICB2bS5kdXJhdGlvbiA9IFwiQ1VTVE9NSVpFXCI7XHJcbiAgICAgICAgICAgIGdldERhdGFMaXN0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL+iuvuWkh+aKpeitpuaVsOWbvuihqOa4suafk1xyXG4gICAgICAgIGZ1bmN0aW9uIGZvcm1hdERhdGFMaXN0KG9yaWdpbmFsRGF0YTpBbGFybVJlc3BvbnNlKXtcclxuICAgICAgICAgICAgbGV0IHhBeGlzRGF0YTpBcnJheTxhbnk+ID0gW107XHJcbiAgICAgICAgICAgIGxldCBhbGxOdW06QXJyYXk8YW55PiA9IFtdO1xyXG4gICAgICAgICAgICBsZXQgb25saW5lTnVtOkFycmF5PGFueT4gPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGxldCBzaG93QXJyOkFycmF5PG9iamVjdD4gPSBkYXRhUGFnaW5nKG9yaWdpbmFsRGF0YS5HUk9VUF9CWV9DQU1FUkEsdm0uY3VycmVudFBhZ2UpO1xyXG5cclxuICAgICAgICAgICAgc2hvd0Fyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtOkFsYXJtR3JvdXBCeUNhbWVyYSwgaW5kZXg6bnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICB4QXhpc0RhdGEucHVzaChpdGVtLmNhbWVyYU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgYWxsTnVtLnB1c2goaXRlbS5hbGxBbGFybU51bSk7XHJcbiAgICAgICAgICAgICAgICBvbmxpbmVOdW0ucHVzaChpdGVtLnZhbGlkQWxhcm1OdW0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGxldCBmb3JtYXREYXRhOm9iamVjdCA9e1xyXG4gICAgICAgICAgICAgICAgc2VyaWVzTmFtZU9uZTon5YWo6YOoJyxcclxuICAgICAgICAgICAgICAgIHNlcmllc05hbWVUd286J+acieaViCcsXHJcbiAgICAgICAgICAgICAgICBncmlkTGVmdDogJzUlJyxcclxuICAgICAgICAgICAgICAgIGdyaWRSaWdodDogJzUlJyxcclxuICAgICAgICAgICAgICAgIHhBeGlzTmFtZTogJycsXHJcbiAgICAgICAgICAgICAgICB5QXhpc05hbWU6ICcnLFxyXG4gICAgICAgICAgICAgICAgY29sb3JUd286IFsnIzhjZGNmZiddLFxyXG4gICAgICAgICAgICAgICAgY29sb3JPbmU6IFsnIzQwYzRmZiddLFxyXG4gICAgICAgICAgICAgICAgLy946L205pWw5o2uXHJcbiAgICAgICAgICAgICAgICB4QXhpc0RhdGE6eEF4aXNEYXRhLFxyXG4gICAgICAgICAgICAgICAgLy/lhajpg6jmlbDmja5cclxuICAgICAgICAgICAgICAgIGFsbE51bTphbGxOdW0sXHJcbiAgICAgICAgICAgICAgICAvL+acieaViOaIlui/kOihjOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgb25saW5lTnVtOm9ubGluZU51bVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBlY2hhcnRTZXJ2aWNlLmRyYXdFY2hhcnQoZWNoYXJ0U2VydmljZS5lY2hhcnRQaWxlQmFyT3B0aW9uKGZvcm1hdERhdGEpLCdhbGFybS0zJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5hcHAuY29udHJvbGxlcignZGV2aWNlQWxhcm1Db250cm9sbGVyJywgRGV2aWNlQWxhcm1Db250cm9sbGVyKTsiXX0=
