define(["require", "exports", "../../common/app/main.app", "../../common/portrait-tool"], function (require, exports, main_app_1, portrait_tool_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var MyCollectViewModel = (function () {
        function MyCollectViewModel() {
        }
        return MyCollectViewModel;
    }());
    exports.MyCollectViewModel = MyCollectViewModel;
    var MyCollectFactory = (function () {
        function MyCollectFactory() {
            this.timeSortArr = [];
            this.timeCollectResultMap = {};
        }
        MyCollectFactory.prototype.cacheDatas = function (datas) {
            this.cookDatas(datas);
        };
        MyCollectFactory.prototype.getDatas = function () {
            var i = 0, len = this.timeSortArr.length, temp, result = [];
            for (; i < len; i++) {
                temp = this.timeSortArr[i];
                result.push({
                    timeKey: temp,
                    isExpand: false,
                    collectResultArr: this.timeCollectResultMap[temp]
                });
            }
            return result;
        };
        MyCollectFactory.prototype.clearDatas = function () {
            this.timeSortArr = [];
            this.timeCollectResultMap = {};
        };
        MyCollectFactory.prototype.removeData = function (model, cacheDatas) {
            var key = this.getYearMonthDay(model.CollectTime);
            var arr = this.timeCollectResultMap[key], i, len, temp, isDelete = false;
            if (arr && arr.length > 0) {
                for (i = 0, len = arr.length; i < len; i++) {
                    if (arr[i].ID === model.ID) {
                        isDelete = true;
                        arr.splice(i, 1);
                        i--;
                        len--;
                        break;
                    }
                }
            }
        };
        MyCollectFactory.prototype.cookDatas = function (datas) {
            var i = 0, len = datas.length, temp;
            for (; i < len; i++) {
                this._cacheData(datas[i]);
            }
        };
        MyCollectFactory.prototype.getYearMonthDay = function (dateStr) {
            if (dateStr == null)
                return;
            var date = portrait_tool_1.default.formatDate(dateStr, "yyyy-MM-dd");
            return date;
        };
        MyCollectFactory.prototype._cacheData = function (data) {
            var key = this.getYearMonthDay(data.CollectTime);
            if (key == null)
                return;
            if (!this.timeCollectResultMap[key]) {
                this.timeCollectResultMap[key] = [];
                this.linkTimeSortAndTimeMap(key);
            }
            this.timeCollectResultMap[key].push(data);
        };
        MyCollectFactory.prototype.linkTimeSortAndTimeMap = function (key) {
            var i = 0, len = this.timeSortArr.length, index = 0;
            for (; i < len; i++) {
                if (this.compareKey(key, this.timeSortArr[i])) {
                    index = i;
                    break;
                }
            }
            this.timeSortArr.splice(i, 0, key);
        };
        MyCollectFactory.prototype.compareKey = function (key1, key2) {
            var date1 = portrait_tool_1.default.parseDate(key1 + " 00:00:00");
            var date2 = portrait_tool_1.default.parseDate(key2 + " 00:00:00");
            if (date1.getTime() > date2.getTime()) {
                return true;
            }
            else {
                return false;
            }
        };
        return MyCollectFactory;
    }());
    exports.MyCollectFactory = MyCollectFactory;
    main_app_1.app.service("myCollectFactory", MyCollectFactory);
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tb2R1bGUvdG9vbE9wdGlvbi9teUNvbGxlY3QvbXlDb2xsZWN0LmNhY2hlLmZhY3RvcnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0lBUUE7UUFBQTtRQU1BLENBQUM7UUFBRCx5QkFBQztJQUFELENBTkEsQUFNQyxJQUFBO0lBTlksZ0RBQWtCO0lBUS9CO1FBSUk7WUFIUSxnQkFBVyxHQUFHLEVBQW1CLENBQUM7WUFDbEMseUJBQW9CLEdBQUcsRUFBeUMsQ0FBQTtRQUd4RSxDQUFDO1FBRUQscUNBQVUsR0FBVixVQUFXLEtBQXVCO1lBQzlCLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDMUIsQ0FBQztRQUVELG1DQUFRLEdBQVI7WUFDSSxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsR0FBRyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxFQUFFLElBQVksRUFBRSxNQUFNLEdBQUcsRUFBK0IsQ0FBQztZQUNqRyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztnQkFDbEIsSUFBSSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzNCLE1BQU0sQ0FBQyxJQUFJLENBQUM7b0JBQ1IsT0FBTyxFQUFFLElBQUk7b0JBQ2IsUUFBUSxFQUFFLEtBQUs7b0JBQ2YsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQztpQkFDcEQsQ0FBQyxDQUFDO1lBQ1AsQ0FBQztZQUNELE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFDbEIsQ0FBQztRQUtELHFDQUFVLEdBQVY7WUFDSSxJQUFJLENBQUMsV0FBVyxHQUFHLEVBQW1CLENBQUM7WUFDdkMsSUFBSSxDQUFDLG9CQUFvQixHQUFHLEVBQXlDLENBQUM7UUFDMUUsQ0FBQztRQU1ELHFDQUFVLEdBQVYsVUFBVyxLQUFnQixFQUFFLFVBQThCO1lBQ3ZELElBQUks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WUFDTCxDQUFDO1lBQ0QsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUN2QyxDQUFDO1FBTU8scUNBQVUsR0FBbEIsVUFBbUIsSUFBWSxFQUFFLElBQVk7WUFFekMsSUFBSSxLQUFLLEdBQUcsdUJBQVksQ0FBQyxTQUFTLENBQUMsSUFBSSxHQUFHLFdBQVcsQ0FBQyxDQUFDO1lBQ3ZELElBQUksS0FBSyxHQUFHLHVCQUFZLENBQUMsU0FBUyxDQUFDLElBQUksR0FBRyxXQUFXLENBQUMsQ0FBQztZQUN2RCxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLEdBQUcsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDcEMsTUFBTSxDQUFDLElBQUksQ0FBQztZQUNoQixDQUFDO1lBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ0osTUFBTSxDQUFDLEtBQUssQ0FBQztZQUNqQixDQUFDO1FBQ0wsQ0FBQztRQUNMLHVCQUFDO0lBQUQsQ0FoSEEsQUFnSEMsSUFBQTtJQWhIWSw0Q0FBZ0I7SUFrSDdCLGNBQUcsQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQyIsImZpbGUiOiJtb2R1bGUvdG9vbE9wdGlvbi9teUNvbGxlY3QvbXlDb2xsZWN0LmNhY2hlLmZhY3RvcnkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2FwcH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9hcHAvbWFpbi5hcHBcIjtcclxuaW1wb3J0IFBvcnRyYWl0VG9vbCBmcm9tICcuLi8uLi9jb21tb24vcG9ydHJhaXQtdG9vbCc7XHJcbmltcG9ydCB7Q29sbGVjdH0gZnJvbSBcIi4uLy4uLy4uL2NvcmUvZW50aXR5L0NvbGxlY3RcIjtcclxuaW1wb3J0IHtDb2xsZWN0RXh9IGZyb20gXCIuLi8uLi8uLi9jb3JlL2VudGl0eS9leC9Db2xsZWN0RXhcIjtcclxuXHJcbi8qKlxyXG4gKiDnlKjkuo7nlYzpnaLlsZXnpLrnlKjnmoRNeVJlcG9ydFZpZXdNb2RlbFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE15Q29sbGVjdFZpZXdNb2RlbCB7XHJcbiAgICAvLyDlvZPliY3orrDlvZXnmoTml7bpl7RrZXlcclxuICAgIHRpbWVLZXk6IHN0cmluZztcclxuICAgIC8vIOaYr+WQpuWxleW8gOaJgOacieiusOW9lVxyXG4gICAgaXNFeHBhbmQ6IGJvb2xlYW47XHJcbiAgICBjb2xsZWN0UmVzdWx0QXJyOiBBcnJheTxDb2xsZWN0RXg+O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgTXlDb2xsZWN0RmFjdG9yeSB7XHJcbiAgICBwcml2YXRlIHRpbWVTb3J0QXJyID0gW10gYXMgQXJyYXk8c3RyaW5nPjtcclxuICAgIHByaXZhdGUgdGltZUNvbGxlY3RSZXN1bHRNYXAgPSB7fSBhcyB7IFtrZXk6IHN0cmluZ106IEFycmF5PENvbGxlY3RFeD4gfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgfVxyXG5cclxuICAgIGNhY2hlRGF0YXMoZGF0YXM6IEFycmF5PENvbGxlY3RFeD4pIHtcclxuICAgICAgICB0aGlzLmNvb2tEYXRhcyhkYXRhcyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGF0YXMoKTogQXJyYXk8TXlDb2xsZWN0Vmlld01vZGVsPiB7XHJcbiAgICAgICAgbGV0IGkgPSAwLCBsZW4gPSB0aGlzLnRpbWVTb3J0QXJyLmxlbmd0aCwgdGVtcDogc3RyaW5nLCByZXN1bHQgPSBbXSBhcyBBcnJheTxNeUNvbGxlY3RWaWV3TW9kZWw+O1xyXG4gICAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgdGVtcCA9IHRoaXMudGltZVNvcnRBcnJbaV07XHJcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHRpbWVLZXk6IHRlbXAsXHJcbiAgICAgICAgICAgICAgICBpc0V4cGFuZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBjb2xsZWN0UmVzdWx0QXJyOiB0aGlzLnRpbWVDb2xsZWN0UmVzdWx0TWFwW3RlbXBdXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6YeN5paw5p+l6K+i5pe2LCDpnIDopoHmiornvJPlrZjnu5nmuIXnkIbmjolcclxuICAgICAqL1xyXG4gICAgY2xlYXJEYXRhcygpIHtcclxuICAgICAgICB0aGlzLnRpbWVTb3J0QXJyID0gW10gYXMgQXJyYXk8c3RyaW5nPjtcclxuICAgICAgICB0aGlzLnRpbWVDb2xsZWN0UmVzdWx0TWFwID0ge30gYXMgeyBba2V5OiBzdHJpbmddOiBBcnJheTxDb2xsZWN0RXg+IH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaTljZXmnaHmlbDmja5cclxuICAgICAqIEBwYXJhbSBtb2RlbCDopoHnp7vpmaTnmoTmkJzol4/mlbDmja4sIOa4suafk+eVjOmdoueUqOeahOaVsOe7hFxyXG4gICAgICovXHJcbiAgICByZW1vdmVEYXRhKG1vZGVsOiBDb2xsZWN0RXgsIGNhY2hlRGF0YXM6IE15Q29sbGVjdFZpZXdNb2RlbCkge1xyXG4gICAgICAgIGxldCBrZXkgPSB0aGlzLmdldFllYXJNb250aERheShtb2RlbC5Db2xsZWN0VGltZSk7XHJcbiAgICAgICAgLy8g6YGN5Y6G5pWw57uELCDmib7liLDlr7nlupTnmoQg5Yig6Zmk5o6JXHJcbiAgICAgICAgbGV0IGFyciA9IHRoaXMudGltZUNvbGxlY3RSZXN1bHRNYXBba2V5XSwgaSwgbGVuLCB0ZW1wOiBNeUNvbGxlY3RWaWV3TW9kZWwsIGlzRGVsZXRlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKGFyciAmJiBhcnIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSBhcnIubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChhcnJbaV0uSUQgPT09IG1vZGVsLklEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g56e76Zmk5o6J6L+Z5p2h5pWw5o2uXHJcbiAgICAgICAgICAgICAgICAgICAgaXNEZWxldGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGFyci5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaS0tO1xyXG4gICAgICAgICAgICAgICAgICAgIGxlbi0tO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNvb2tEYXRhcyhkYXRhczogQXJyYXk8Q29sbGVjdEV4Pikge1xyXG4gICAgICAgIC8vIOWvueaVsOaNrui/m+ihjOWKoOW3pS4g5oyJ54Wn5pe26Ze057u05bqm5p2l57uE6KOF5pWw5o2uXHJcbiAgICAgICAgbGV0IGkgPSAwLCBsZW4gPSBkYXRhcy5sZW5ndGgsIHRlbXA7XHJcbiAgICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9jYWNoZURhdGEoZGF0YXNbaV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaKpeitpueahOW5tOaciOaXpVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldFllYXJNb250aERheShkYXRlU3RyOiBzdHJpbmcpIHtcclxuICAgICAgICBpZiAoZGF0ZVN0ciA9PSBudWxsKSByZXR1cm47XHJcbiAgICAgICAgbGV0IGRhdGUgPSBQb3J0cmFpdFRvb2wuZm9ybWF0RGF0ZShkYXRlU3RyLCBcInl5eXktTU0tZGRcIik7XHJcbiAgICAgICAgcmV0dXJuIGRhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfY2FjaGVEYXRhKGRhdGE6IENvbGxlY3RFeCkge1xyXG4gICAgICAgIGxldCBrZXkgPSB0aGlzLmdldFllYXJNb250aERheShkYXRhLkNvbGxlY3RUaW1lKTtcclxuICAgICAgICBpZiAoa2V5ID09IG51bGwpIHJldHVybjtcclxuICAgICAgICBpZiAoIXRoaXMudGltZUNvbGxlY3RSZXN1bHRNYXBba2V5XSkge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVDb2xsZWN0UmVzdWx0TWFwW2tleV0gPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5saW5rVGltZVNvcnRBbmRUaW1lTWFwKGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudGltZUNvbGxlY3RSZXN1bHRNYXBba2V5XS5wdXNoKGRhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5bCG5pe26Ze05o6S5bqP5pWw57uE5ZKM5pe26Ze057uT5p6cbWFw5oOz5YWz6IGUXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgbGlua1RpbWVTb3J0QW5kVGltZU1hcChrZXk6IHN0cmluZykge1xyXG4gICAgICAgIC8vIOagueaNrmRhdGXmnaXov5vooYzmjpLluo8sIOWwhuWvueW6lOeahGtleeaMieeFp2RhdGXnmoTmjpLluo/liqDlhaXliLB0aW1lU29ydEFyciDkv53or4F0aW1lU29ydEFycumHjOeahGtleemDveaYr+aMieeFp+aXtumXtOS7juWJjeWIsOWQjueahOaVsOaNruWtmOaUvlxyXG4gICAgICAgIGxldCBpID0gMCwgbGVuID0gdGhpcy50aW1lU29ydEFyci5sZW5ndGgsIGluZGV4ID0gMDtcclxuICAgICAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIC8vIOmAu+i+kTog5Yik5pat5b2T5YmN6KaB5o+S5YWl55qEa2V55ZKM546w5pyJ5pWw57uE55qE5YC86YGN5Y6GLCDoi6VrZXnmr5Rp5a+55bqU55qE5YC85aSn5LqGLCDliJnmj5LlhaXliLBp5a+55bqU55qE5YC85LmL5YmNXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbXBhcmVLZXkoa2V5LCB0aGlzLnRpbWVTb3J0QXJyW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgaW5kZXggPSBpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50aW1lU29ydEFyci5zcGxpY2UoaSwgMCwga2V5KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOavlOi+g+S4pOS4qmtleVxyXG4gICAgICogQHJldHVybiB0cnVlIOihqOekuiBrZXkx5q+Ua2V5MuWkpywgZmFsc2Uga2V5MSDmr5Qga2V5MuWwj1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNvbXBhcmVLZXkoa2V5MTogc3RyaW5nLCBrZXkyOiBzdHJpbmcpIHtcclxuICAgICAgICAvLyDkuLvliqjloZ7kuIrml7bpl7RcclxuICAgICAgICBsZXQgZGF0ZTEgPSBQb3J0cmFpdFRvb2wucGFyc2VEYXRlKGtleTEgKyBcIiAwMDowMDowMFwiKTtcclxuICAgICAgICBsZXQgZGF0ZTIgPSBQb3J0cmFpdFRvb2wucGFyc2VEYXRlKGtleTIgKyBcIiAwMDowMDowMFwiKTtcclxuICAgICAgICBpZiAoZGF0ZTEuZ2V0VGltZSgpID4gZGF0ZTIuZ2V0VGltZSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmFwcC5zZXJ2aWNlKFwibXlDb2xsZWN0RmFjdG9yeVwiLCBNeUNvbGxlY3RGYWN0b3J5KTsiXX0=
