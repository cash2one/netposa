define(["require", "exports", "../../core/enum/TreeType", "../../core/entity/OperFirstModule", "../../core/entity/OperSecondModule", "../../core/entity/OperThirdModule", "jquery.md5", "angular", "ua-parser-js"], function (require, exports, TreeType_1, OperFirstModule_1, OperSecondModule_1, OperThirdModule_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var UAParser = require("ua-parser-js");
    var PortraitTool = (function () {
        function PortraitTool() {
        }
        PortraitTool.getBrowser = function () {
            return PortraitTool.browser;
        };
        PortraitTool.getIEVer = function () {
            var result = 0;
            if (PortraitTool.browser.name.toUpperCase() == 'IE') {
                result = Number(PortraitTool.browser.major);
            }
            return result;
        };
        ;
        PortraitTool.getLocalStorageData = function (key) {
            var result = null;
            try {
                result = angular.fromJson(localStorage.getItem(key));
            }
            catch (e) {
                result = null;
            }
            return result;
        };
        PortraitTool.extend = function (__params1, __params2, __params3, __params4) {
            var options, name, src, copy, copyIsArray, clone, target = arguments[0] || {}, i = 1, length = arguments.length, deep = false, toString = Object.prototype.toString, hasOwn = Object.prototype.hasOwnProperty, push = Array.prototype.push, slice = Array.prototype.slice, trim = String.prototype.trim, indexOf = Array.prototype.indexOf, class2type = {
                "[object Boolean]": "boolean",
                "[object Number]": "number",
                "[object String]": "string",
                "[object Function]": "function",
                "[object Array]": "array",
                "[object Date]": "date",
                "[object RegExp]": "regexp",
                "[object Object]": "object"
            }, jQuery = {
                isFunction: function (obj) {
                    return jQuery.type(obj) === "function";
                },
                isArray: Array.isArray ||
                    function (obj) {
                        return jQuery.type(obj) === "array";
                    },
                isWindow: function (obj) {
                    return obj != null && obj == obj.window;
                },
                isNumeric: function (obj) {
                    return !isNaN(parseFloat(obj)) && isFinite(obj);
                },
                type: function (obj) {
                    return obj == null ? String(obj) : class2type[toString.call(obj)] || "object";
                },
                isPlainObject: function (obj) {
                    if (!obj || jQuery.type(obj) !== "object" || obj.nodeType) {
                        return false;
                    }
                    try {
                        if (obj.constructor && !hasOwn.call(obj, "constructor") && !hasOwn.call(obj.constructor.prototype, "isPrototypeOf")) {
                            return false;
                        }
                    }
                    catch (e) {
                        return false;
                    }
                    var key;
                    for (key in obj) {
                    }
                    return key === undefined || hasOwn.call(obj, key);
                }
            };
            if (typeof target === "boolean") {
                deep = target;
                target = arguments[1] || {};
                i = 2;
            }
            if (typeof target !== "object" && !jQuery.isFunction(target)) {
                target = {};
            }
            if (length === i) {
                target = this;
                --i;
            }
            for (i; i < length; i++) {
                if ((options = arguments[i]) != null) {
                    for (name in options) {
                        src = target[name];
                        copy = options[name];
                        if (target === copy) {
                            continue;
                        }
                        if (deep && copy && (jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)))) {
                            if (copyIsArray) {
                                copyIsArray = false;
                                clone = src && jQuery.isArray(src) ? src : [];
                            }
                            else {
                                clone = src && jQuery.isPlainObject(src) ? src : {};
                            }
                            target[name] = PortraitTool.extend(deep, clone, copy);
                        }
                        else if (copy !== undefined) {
                            target[name] = copy;
                        }
                    }
                }
            }
            return target;
        };
        PortraitTool.getUUID = function () {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        };
        PortraitTool.classifyDiffChild = function (params, multipleDataList) {
            var idAddStr = "+";
            var selfName = "（" + (!!params.newChildName ? params.newChildName : "本区域") + "）";
            var defaultParams = {
                newChildNameStr: selfName,
                nameKeyStr: !!params.nameKey ? params.nameKey : "Name",
                treeIdKey: !!params.idKeyName ? params.idKeyName : "treeID",
                treePidKey: !!params.pidKeyName ? params.pidKeyName : "treeParentId",
                treeTypeKey: !!params.treeTypeKey ? params.treeTypeKey : "treeType",
                currentType: !!params.currentType ? params.currentType : TreeType_1.TreeType.area.value
            };
            var convertAddNode = function (nodeData, newChildName, newChildKey) {
                var nameKey = defaultParams.nameKeyStr;
                var newNode = angular.copy(nodeData);
                newNode[nameKey] = newChildName + newNode[nameKey];
                newNode[defaultParams.treePidKey] = nodeData[defaultParams.treeIdKey];
                newNode[defaultParams.treeIdKey] = idAddStr + nodeData[defaultParams.treeIdKey];
                return newNode;
            };
            var mainTypeNodes = [], mainTypeNodesMap = {}, addNodes = [], diffNodes = [];
            angular.forEach(multipleDataList[0], function (val) {
                if (val[defaultParams.treeTypeKey] === defaultParams.currentType) {
                    mainTypeNodesMap[val[defaultParams.treeIdKey]] = val;
                    mainTypeNodes.push(val);
                }
                else {
                    diffNodes.push(val);
                }
            });
            angular.forEach(multipleDataList, function (val, i) {
                if (i > 0 && angular.isArray(val)) {
                    diffNodes = diffNodes.concat(val);
                }
            });
            var addNode = null;
            var addNodeMap = {};
            angular.forEach(diffNodes, function (val) {
                addNode = mainTypeNodesMap[val[defaultParams.treePidKey]];
                if (val[defaultParams.treePidKey] && addNode && (val[defaultParams.treeTypeKey] !== defaultParams.currentType)) {
                    if (!addNodeMap[val[defaultParams.treePidKey]]) {
                        addNodeMap[val[defaultParams.treePidKey]] = true;
                        addNode = convertAddNode(addNode, defaultParams.newChildNameStr, defaultParams.nameKeyStr);
                        addNodes.push(addNode);
                    }
                    else {
                    }
                    val[defaultParams.treePidKey] = idAddStr + val[defaultParams.treePidKey];
                }
            });
            return addNodes.concat(mainTypeNodes, diffNodes);
        };
        PortraitTool.getChineseModuleName = function (moduleName) {
            var FitstModule = angular.copy(OperFirstModule_1.OperFitstModule);
            var SecondModule = angular.copy(OperSecondModule_1.OperSecondModule);
            var ThirdModule = angular.copy(OperThirdModule_1.OperThirdModule);
            if (FitstModule[moduleName]) {
                return FitstModule[moduleName].name;
            }
            else if (SecondModule[moduleName]) {
                return SecondModule[moduleName].name;
            }
            else if (ThirdModule[moduleName]) {
                return ThirdModule[moduleName].name;
            }
            else {
                return "";
            }
        };
        PortraitTool.browser = (function () {
            return new UAParser().getResult().browser;
        })();
        PortraitTool.convert2Ztree = function (sNodes, idKey, parentKey, childKey) {
            var i, l, key = idKey, parentKey = parentKey, childKey = childKey;
            var r = [];
            var tmpMap = [];
            for (i = 0, l = sNodes.length; i < l; i++) {
                tmpMap[sNodes[i][key]] = sNodes[i];
            }
            for (i = 0, l = sNodes.length; i < l; i++) {
                if (tmpMap[sNodes[i][parentKey]] && sNodes[i][key] != sNodes[i][parentKey]) {
                    if (!tmpMap[sNodes[i][parentKey]][childKey])
                        tmpMap[sNodes[i][parentKey]][childKey] = [];
                    tmpMap[sNodes[i][parentKey]][childKey].push(sNodes[i]);
                }
                else {
                    r.push(sNodes[i]);
                }
            }
            return r;
        };
        PortraitTool.deepCopy = function (o) {
            if (o instanceof Array) {
                var n = [];
                for (var i = 0; i < o.length; ++i) {
                    n[i] = this.deepCopy(o[i]);
                }
                return n;
            }
            else if (o instanceof Object) {
                var n = {};
                for (var i in o) {
                    n[i] = this.deepCopy(o[i]);
                }
                return n;
            }
            else {
                return o;
            }
        };
        PortraitTool.md5 = function (origin) {
            return $.md5(origin);
        };
        PortraitTool.formatDate = function (v, format) {
            if (!format) {
                format = "yyyy-MM-dd hh:mm:ss";
            }
            if (typeof v == 'string')
                v = this.parseDate(v);
            if (!(v instanceof Date)) {
                return '';
            }
            var o = {
                "M+": v.getMonth() + 1,
                "d+": v.getDate(),
                "h+": v.getHours(),
                "m+": v.getMinutes(),
                "s+": v.getSeconds(),
                "q+": Math.floor((v.getMonth() + 3) / 3),
                "S": v.getMilliseconds()
            };
            if (/(y+)/.test(format)) {
                format = format.replace(RegExp.$1, (v.getFullYear() + "").substr(4 - RegExp.$1.length));
            }
            for (var k in o) {
                if (new RegExp("(" + k + ")").test(format)) {
                    format = format.replace(RegExp.$1, RegExp.$1.length == 1 ? o[k] : ("00" + o[k]).substr(("" + o[k]).length));
                }
            }
            return format;
        };
        PortraitTool.parseDate = function (str) {
            if (typeof str == 'string') {
                var results = str.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) *$/);
                if (results && results.length > 3)
                    return new Date(parseInt(results[1], 10), parseInt(results[2], 10) - 1, parseInt(results[3], 10));
                results = str.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2}) *$/);
                if (results && results.length > 6)
                    return new Date(parseInt(results[1], 10), parseInt(results[2], 10) - 1, parseInt(results[3], 10), parseInt(results[4], 10), parseInt(results[5], 10), parseInt(results[6], 10));
                results = str.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2})\.(\d{1,5}) *$/);
                if (results && results.length > 7)
                    return new Date(parseInt(results[1], 10), parseInt(results[2], 10) - 1, parseInt(results[3], 10), parseInt(results[4], 10), parseInt(results[5], 10), parseInt(results[6], 10), parseInt(results[7], 10));
            }
            return null;
        };
        PortraitTool.addYears = function (date, value) {
            date.setFullYear(date.getFullYear() + value);
            return date;
        };
        PortraitTool.addDays = function (date, value) {
            date.setDate(date.getDate() + value);
            return date;
        };
        PortraitTool.addHours = function (date, value) {
            date.setHours(date.getHours() + value);
            return date;
        };
        PortraitTool.addSeconds = function (date, value) {
            date.setSeconds(date.getSeconds() + value);
            return date;
        };
        PortraitTool.addMinutes = function (date, value) {
            date.setMinutes(date.getMinutes() + value);
            return date;
        };
        return PortraitTool;
    }());
    exports.default = PortraitTool;
    ;
    var ClassifyDiffChildParams = (function () {
        function ClassifyDiffChildParams() {
            this.currentType = TreeType_1.TreeType.area.value;
            this.newChildName = "（本部）";
            this.nameKey = "Name";
            this.idKeyName = "treeID";
            this.pidKeyName = "treeParentId";
            this.treeTypeKey = "treeType";
        }
        return ClassifyDiffChildParams;
    }());
    exports.ClassifyDiffChildParams = ClassifyDiffChildParams;
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tb2R1bGUvY29tbW9uL3BvcnRyYWl0LXRvb2wudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0lBT0EsSUFBSSxRQUFRLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBVXZDO1FBQUE7UUFrWkEsQ0FBQztRQXJZVSx1QkFBVSxHQUFqQjtZQUNJLE1BQU0sQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDO1FBQ2hDLENBQUM7UUFPTSxxQkFBUSxHQUFmO1lBQ0ksSUFBSSxNQUFNLEdBQUcsQ0FBQyxDQUFDO1lBQ2YsRUFBRSxDQUFDLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztnQkFDbEQsTUFBTSxHQUFHLE1BQU0sQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2hELENBQUM7WUFDRCxNQUFNLENBQUMsTUFBTSxDQUFDO1FBQ2xCLENBQUM7UUFBQSxDQUFDO1FBNERLLGdDQUFtQixHQUExQixVQUEyQixHQUFXO1lBQ2xDLElBQUksTUFBTSxHQUFRLElBQUksQ0FBQztZQUN2QixJQUFJLENBQUM7Z0JBQ0QsTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQ3pELENBQUM7WUFBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNULE1BQU0sR0FBRyxJQUFJLENBQUM7WUFDbEIsQ0FBQztZQUNELE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFDbEIsQ0FBQztRQXNHTSxtQkFBTSxHQUFiLFVBQWMsU0FBZSxFQUFFLFNBQWUsRUFBRSxTQUFlLEVBQUUsU0FBZTtZQUM1RSxJQUFJLE9BQVksRUFBRSxJQUFTLEVBQUUsR0FBUSxFQUFFLElBQVMsRUFBRSxXQUFnQixFQUFFLEtBQVUsRUFDMUUsTUFBTSxHQUFRLFNBQVMsQ0FBQyxDQUFD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RUFBRSxDQUFDLEVBQUUsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRSxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUNsTixDQUFDO1lBQ0QsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDLENBQUM7UUFFSyxxQkFBUSxHQUFHLFVBQVUsSUFBVSxFQUFFLEtBQWE7WUFDakQsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLEdBQUcsS0FBSyxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDLENBQUM7UUFFSyxvQkFBTyxHQUFHLFVBQVUsSUFBVSxFQUFFLEtBQWE7WUFDaEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLEdBQUcsS0FBSyxDQUFDLENBQUM7WUFDckMsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDLENBQUM7UUFFSyxxQkFBUSxHQUFHLFVBQVUsSUFBVSxFQUFFLEtBQWE7WUFDakQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsS0FBSyxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDLENBQUM7UUFDSyx1QkFBVSxHQUFHLFVBQVUsSUFBVSxFQUFFLEtBQWE7WUFDbkQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLEdBQUcsS0FBSyxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDLENBQUM7UUFDSyx1QkFBVSxHQUFHLFVBQVMsSUFBVSxFQUFFLEtBQWE7WUFDbEQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLEdBQUcsS0FBSyxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDLENBQUE7UUFtTkwsbUJBQUM7S0FsWkQsQUFrWkMsSUFBQTtzQkFsWm9CLFlBQVk7SUFrWmhDLENBQUM7SUFFRjtRQVFJO1lBQ0ksSUFBSSxDQUFDLFdBQVcsR0FBRyxtQkFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDdkMsSUFBSSxDQUFDLFlBQVksR0FBRyxNQUFNLENBQUM7WUFDM0IsSUFBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7WUFDdEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxRQUFRLENBQUM7WUFDMUIsSUFBSSxDQUFDLFVBQVUsR0FBRyxjQUFjLENBQUM7WUFDakMsSUFBSSxDQUFDLFdBQVcsR0FBRyxVQUFVLENBQUM7UUFDbEMsQ0FBQztRQUNMLDhCQUFDO0lBQUQsQ0FoQkEsQUFnQkMsSUFBQTtJQWhCWSwwREFBdUIiLCJmaWxlIjoibW9kdWxlL2NvbW1vbi9wb3J0cmFpdC10b29sLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwianF1ZXJ5Lm1kNVwiO1xyXG5pbXBvcnQgXCJhbmd1bGFyXCI7XHJcbmltcG9ydCBcInVhLXBhcnNlci1qc1wiO1xyXG5cclxuZGVjbGFyZSB2YXIgJDogYW55O1xyXG5kZWNsYXJlIHZhciBhbmd1bGFyOiBhbnk7XHJcbmRlY2xhcmUgdmFyIHJlcXVpcmU6IGFueTtcclxubGV0IFVBUGFyc2VyID0gcmVxdWlyZShcInVhLXBhcnNlci1qc1wiKTtcclxuaW1wb3J0IHtUcmVlVHlwZX0gZnJvbSBcIi4uLy4uL2NvcmUvZW51bS9UcmVlVHlwZVwiO1xyXG5pbXBvcnQge09wZXJGaXRzdE1vZHVsZX0gZnJvbSBcIi4uLy4uL2NvcmUvZW50aXR5L09wZXJGaXJzdE1vZHVsZVwiO1xyXG5pbXBvcnQge09wZXJTZWNvbmRNb2R1bGV9IGZyb20gXCIuLi8uLi9jb3JlL2VudGl0eS9PcGVyU2Vjb25kTW9kdWxlXCI7XHJcbmltcG9ydCB7T3BlclRoaXJkTW9kdWxlfSBmcm9tIFwiLi4vLi4vY29yZS9lbnRpdHkvT3BlclRoaXJkTW9kdWxlXCI7XHJcblxyXG4vKipcclxuICog55uR5o6n5q+U5a+557O757uf55qE5bel5YW357G7XHJcbiAqIOatpOW3peWFt+exu+S4jeWMheWQq+S7u+S9leS4muWKoemAu+i+keWIpOaWrVxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9ydHJhaXRUb29sIHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOWIneWni+WMluiOt+W+l+a1j+iniOWZqOeJiOacrFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHN0YXRpYyBicm93c2VyOiBhbnkgPSAoKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgVUFQYXJzZXIoKS5nZXRSZXN1bHQoKS5icm93c2VyO1xyXG4gICAgfSkoKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlua1j+iniOWZqOeJiOacrFxyXG4gICAgICogQHJldHVybnMge2FueX1cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGdldEJyb3dzZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIFBvcnRyYWl0VG9vbC5icm93c2VyO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+WaWXnmoTniYjmnKxcclxuICAgICAqIOiLpeS4jeaYr2llLCDliJnov5Tlm54wXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgZ2V0SUVWZXIoKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IDA7XHJcbiAgICAgICAgaWYgKFBvcnRyYWl0VG9vbC5icm93c2VyLm5hbWUudG9VcHBlckNhc2UoKSA9PSAnSUUnKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IE51bWJlcihQb3J0cmFpdFRvb2wuYnJvd3Nlci5tYWpvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog6L2s5o2i5Li6enRyZWXnmoTmoJHlvaLnu5PmnoQo5bimY2hpbGRyZW7nmoTnu5PmnoQpXHJcbiAgICAgKiBAcGFyYW0gbm9kZXMg5Lyg5YWl55qE57uT5p6EXHJcbiAgICAgKiBAcGFyYW0gaWRLZXlcclxuICAgICAqIEBwYXJhbSBwYXJlbnRLZXlcclxuICAgICAqIEBwYXJhbSBjaGlsZEtleVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY29udmVydDJadHJlZSA9IGZ1bmN0aW9uIChzTm9kZXM6IGFueSwgaWRLZXk6IHN0cmluZywgcGFyZW50S2V5OiBzdHJpbmcsIGNoaWxkS2V5OiBzdHJpbmcpIHtcclxuICAgICAgICB2YXIgaSwgbCxcclxuICAgICAgICAgICAga2V5ID0gaWRLZXksXHJcbiAgICAgICAgICAgIHBhcmVudEtleSA9IHBhcmVudEtleSxcclxuICAgICAgICAgICAgY2hpbGRLZXkgPSBjaGlsZEtleTtcclxuICAgICAgICB2YXIgciA9IFtdO1xyXG4gICAgICAgIHZhciB0bXBNYXAgPSBbXTtcclxuICAgICAgICBmb3IgKGkgPSAwLCBsID0gc05vZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICB0bXBNYXBbc05vZGVzW2ldW2tleV1dID0gc05vZGVzW2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGkgPSAwLCBsID0gc05vZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodG1wTWFwW3NOb2Rlc1tpXVtwYXJlbnRLZXldXSAmJiBzTm9kZXNbaV1ba2V5XSAhPSBzTm9kZXNbaV1bcGFyZW50S2V5XSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0bXBNYXBbc05vZGVzW2ldW3BhcmVudEtleV1dW2NoaWxkS2V5XSlcclxuICAgICAgICAgICAgICAgICAgICB0bXBNYXBbc05vZGVzW2ldW3BhcmVudEtleV1dW2NoaWxkS2V5XSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdG1wTWFwW3NOb2Rlc1tpXVtwYXJlbnRLZXldXVtjaGlsZEtleV0ucHVzaChzTm9kZXNbaV0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgci5wdXNoKHNOb2Rlc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHI7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5rex5ou36LSdLCDlj6/ku6Xmj5Dlj5blhazlhbHmlrnms5VcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGRlZXBDb3B5ID0gZnVuY3Rpb24gKG86IGFueSkge1xyXG4gICAgICAgIGlmIChvIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgbGV0IG46IGFueSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG8ubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIG5baV0gPSB0aGlzLmRlZXBDb3B5KG9baV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuO1xyXG5cclxuICAgICAgICB9IGVsc2UgaWYgKG8gaW5zdGFuY2VvZiBPYmplY3QpIHtcclxuICAgICAgICAgICAgbGV0IG46IGFueSA9IHt9O1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpIGluIG8pIHtcclxuICAgICAgICAgICAgICAgIG5baV0gPSB0aGlzLmRlZXBDb3B5KG9baV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEB0aW1lOiAyMDE3LTA3LTI3IDE1OjAwOjEzXHJcbiAgICAgKiBAcGFyYW1zOlxyXG4gICAgICogQHJldHVybjpcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGdldExvY2FsU3RvcmFnZURhdGEoa2V5OiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgcmVzdWx0OiBhbnkgPSBudWxsO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IGFuZ3VsYXIuZnJvbUpzb24obG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIG1kNeWKoOWvhlxyXG4gICAgICogQHBhcmFtIG9yaWdpblxyXG4gICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAqL1xyXG4gICAgc3RhdGljIG1kNSA9IGZ1bmN0aW9uIChvcmlnaW46IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuICQubWQ1KG9yaWdpbik7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qXHJcbiAgICAgKuWwhkRhdGUvU3RyaW5n57G75Z6LLOino+aekOS4ulN0cmluZ+exu+Weiy5cclxuICAgICAq5Lyg5YWlU3RyaW5n57G75Z6LLOWImeWFiOino+aekOS4ukRhdGXnsbvlnotcclxuICAgICAq5LiN5q2j56Gu55qERGF0ZSzov5Tlm54gJydcclxuICAgICAq5aaC5p6c5pe26Ze06YOo5YiG5Li6MCzliJnlv73nlaUs5Y+q6L+U5Zue5pel5pyf6YOo5YiGLlxyXG4gICAgICrml6XmnJ/moLzlvI/lr7nlupTlrZfnrKblpoLkuIso5bm0LXl5eXks5pyILU1NLOaXpS1kZCzml7YtaGgs5YiGLW1tLOenki1zcyzmr6vnp5ItUyDlrZfnrKbljLrliIblpKflsI/lhpkpXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBmb3JtYXREYXRlID0gZnVuY3Rpb24gKHY6IERhdGUgJiBzdHJpbmcgJiBhbnksIGZvcm1hdD86IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKCFmb3JtYXQpIHtcclxuICAgICAgICAgICAgZm9ybWF0ID0gXCJ5eXl5LU1NLWRkIGhoOm1tOnNzXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgdiA9PSAnc3RyaW5nJykgdiA9IHRoaXMucGFyc2VEYXRlKHYpO1xyXG4gICAgICAgIGlmICghKHYgaW5zdGFuY2VvZiBEYXRlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBvOiBhbnkgPSB7XHJcbiAgICAgICAgICAgIFwiTStcIjogdi5nZXRNb250aCgpICsgMSwgLy9tb250aFxyXG4gICAgICAgICAgICBcImQrXCI6IHYuZ2V0RGF0ZSgpLCAvL2RheVxyXG4gICAgICAgICAgICBcImgrXCI6IHYuZ2V0SG91cnMoKSwgLy9ob3VyXHJcbiAgICAgICAgICAgIFwibStcIjogdi5nZXRNaW51dGVzKCksIC8vbWludXRlXHJcbiAgICAgICAgICAgIFwicytcIjogdi5nZXRTZWNvbmRzKCksIC8vc2Vjb25kXHJcbiAgICAgICAgICAgIFwicStcIjogTWF0aC5mbG9vcigodi5nZXRNb250aCgpICsgMykgLyAzKSwgLy9xdWFydGVyXHJcbiAgICAgICAgICAgIFwiU1wiOiB2LmdldE1pbGxpc2Vjb25kcygpIC8vbWlsbGlzZWNvbmRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoLyh5KykvLnRlc3QoZm9ybWF0KSkge1xyXG4gICAgICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZShSZWdFeHAuJDEsICh2LmdldEZ1bGxZZWFyKCkgKyBcIlwiKS5zdWJzdHIoNCAtIFJlZ0V4cC4kMS5sZW5ndGgpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAodmFyIGsgaW4gbykge1xyXG4gICAgICAgICAgICBpZiAobmV3IFJlZ0V4cChcIihcIiArIGsgKyBcIilcIikudGVzdChmb3JtYXQpKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZShSZWdFeHAuJDEsIFJlZ0V4cC4kMS5sZW5ndGggPT0gMSA/IG9ba10gOiAoXCIwMFwiICsgb1trXSkuc3Vic3RyKChcIlwiICsgb1trXSkubGVuZ3RoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZvcm1hdDtcclxuICAgIH07XHJcblxyXG4gICAgLypcclxuICAgICDlsIZTdHJpbmfnsbvlnovop6PmnpDkuLpEYXRl57G75Z6LLlxyXG4gICAgIHBhcnNlRGF0ZSgnMjAwNi0xLTEnKSByZXR1cm4gbmV3IERhdGUoMjAwNiwwLDEpXHJcbiAgICAgcGFyc2VEYXRlKCcgMjAwNi0xLTEgJykgcmV0dXJuIG5ldyBEYXRlKDIwMDYsMCwxKVxyXG4gICAgIHBhcnNlRGF0ZSgnMjAwNi0xLTEgMTU6MTQ6MTYnKSByZXR1cm4gbmV3IERhdGUoMjAwNiwwLDEsMTUsMTQsMTYpXHJcbiAgICAgcGFyc2VEYXRlKCcgMjAwNi0xLTEgMTU6MTQ6MTYgJykgcmV0dXJuIG5ldyBEYXRlKDIwMDYsMCwxLDE1LDE0LDE2KTtcclxuICAgICBwYXJzZURhdGUoJzIwMDYtMS0xIDE1OjE0OjE2LjI1NCcpIHJldHVybiBuZXcgRGF0ZSgyMDA2LDAsMSwxNSwxNCwxNiwyNTQpXHJcbiAgICAgcGFyc2VEYXRlKCcgMjAwNi0xLTEgMTU6MTQ6MTYuMjU0ICcpIHJldHVybiBuZXcgRGF0ZSgyMDA2LDAsMSwxNSwxNCwxNiwyNTQpXHJcbiAgICAgcGFyc2VEYXRlKCfkuI3mraPnoa7nmoTmoLzlvI8nKSByZXRydW4gbnVsbFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgcGFyc2VEYXRlID0gZnVuY3Rpb24gKHN0cjogYW55KSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBzdHIgPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBzdHIubWF0Y2goL14gKihcXGR7NH0pLShcXGR7MSwyfSktKFxcZHsxLDJ9KSAqJC8pO1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0cyAmJiByZXN1bHRzLmxlbmd0aCA+IDMpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUocGFyc2VJbnQocmVzdWx0c1sxXSwgMTApLCBwYXJzZUludChyZXN1bHRzWzJdLCAxMCkgLSAxLCBwYXJzZUludChyZXN1bHRzWzNdLCAxMCkpO1xyXG4gICAgICAgICAgICByZXN1bHRzID0gc3RyLm1hdGNoKC9eICooXFxkezR9KS0oXFxkezEsMn0pLShcXGR7MSwyfSkgKyhcXGR7MSwyfSk6KFxcZHsxLDJ9KTooXFxkezEsMn0pICokLyk7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHRzICYmIHJlc3VsdHMubGVuZ3RoID4gNilcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShwYXJzZUludChyZXN1bHRzWzFdLCAxMCksIHBhcnNlSW50KHJlc3VsdHNbMl0sIDEwKSAtIDEsIHBhcnNlSW50KHJlc3VsdHNbM10sIDEwKSwgcGFyc2VJbnQocmVzdWx0c1s0XSwgMTApLCBwYXJzZUludChyZXN1bHRzWzVdLCAxMCksIHBhcnNlSW50KHJlc3VsdHNbNl0sIDEwKSk7XHJcbiAgICAgICAgICAgIHJlc3VsdHMgPSBzdHIubWF0Y2goL14gKihcXGR7NH0pLShcXGR7MSwyfSktKFxcZHsxLDJ9KSArKFxcZHsxLDJ9KTooXFxkezEsMn0pOihcXGR7MSwyfSlcXC4oXFxkezEsNX0pICokLyk7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHRzICYmIHJlc3VsdHMubGVuZ3RoID4gNylcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShwYXJzZUludChyZXN1bHRzWzFdLCAxMCksIHBhcnNlSW50KHJlc3VsdHNbMl0sIDEwKSAtIDEsIHBhcnNlSW50KHJlc3VsdHNbM10sIDEwKSwgcGFyc2VJbnQocmVzdWx0c1s0XSwgMTApLCBwYXJzZUludChyZXN1bHRzWzVdLCAxMCksIHBhcnNlSW50KHJlc3VsdHNbNl0sIDEwKSwgcGFyc2VJbnQocmVzdWx0c1s3XSwgMTApKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG5cclxuICAgIHN0YXRpYyBhZGRZZWFycyA9IGZ1bmN0aW9uIChkYXRlOiBEYXRlLCB2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICAgICAgZGF0ZS5zZXRGdWxsWWVhcihkYXRlLmdldEZ1bGxZZWFyKCkgKyB2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGU7XHJcbiAgICB9O1xyXG4gICAgLy/lop7liqDlpKlcclxuICAgIHN0YXRpYyBhZGREYXlzID0gZnVuY3Rpb24gKGRhdGU6IERhdGUsIHZhbHVlOiBudW1iZXIpIHtcclxuICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgKyB2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGU7XHJcbiAgICB9O1xyXG4gICAgLy/lop7liqDlsI/ml7ZcclxuICAgIHN0YXRpYyBhZGRIb3VycyA9IGZ1bmN0aW9uIChkYXRlOiBEYXRlLCB2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICAgICAgZGF0ZS5zZXRIb3VycyhkYXRlLmdldEhvdXJzKCkgKyB2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGU7XHJcbiAgICB9O1xyXG4gICAgc3RhdGljIGFkZFNlY29uZHMgPSBmdW5jdGlvbiAoZGF0ZTogRGF0ZSwgdmFsdWU6IG51bWJlcikge1xyXG4gICAgICAgIGRhdGUuc2V0U2Vjb25kcyhkYXRlLmdldFNlY29uZHMoKSArIHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gZGF0ZTtcclxuICAgIH07XHJcbiAgICBzdGF0aWMgYWRkTWludXRlcyA9IGZ1bmN0aW9uKGRhdGU6IERhdGUsIHZhbHVlOiBudW1iZXIpe1xyXG4gICAgICAgIGRhdGUuc2V0TWludXRlcyhkYXRlLmdldE1pbnV0ZXMoKSArIHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gZGF0ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOS7v+eFp2pxdWVyeS5leHRlbmTmlrnms5VcclxuICAgICAqIOS9v+eUqOaWueW8jyAgZXh0ZW5kKHt9LCB7fSk7IOa3seaLt+i0nSBleHRlbmQodHJ1ZSwge30sIHt9KTtcclxuICAgICAqIEByZXR1cm5zIHthbnl8e319XHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBleHRlbmQoX19wYXJhbXMxPzogYW55LCBfX3BhcmFtczI/OiBhbnksIF9fcGFyYW1zMz86IGFueSwgX19wYXJhbXM0PzogYW55KTogYW55IHtcclxuICAgICAgICB2YXIgb3B0aW9uczogYW55LCBuYW1lOiBhbnksIHNyYzogYW55LCBjb3B5OiBhbnksIGNvcHlJc0FycmF5OiBhbnksIGNsb25lOiBhbnksXHJcbiAgICAgICAgICAgIHRhcmdldDogYW55ID0gYXJndW1lbnRzWzBdIHx8IHt9LFxyXG4gICAgICAgICAgICBpID0gMSxcclxuICAgICAgICAgICAgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aCxcclxuICAgICAgICAgICAgZGVlcCA9IGZhbHNlLFxyXG4gICAgICAgICAgICB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsXHJcbiAgICAgICAgICAgIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksXHJcbiAgICAgICAgICAgIHB1c2ggPSBBcnJheS5wcm90b3R5cGUucHVzaCxcclxuICAgICAgICAgICAgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UsXHJcbiAgICAgICAgICAgIHRyaW0gPSBTdHJpbmcucHJvdG90eXBlLnRyaW0sXHJcbiAgICAgICAgICAgIGluZGV4T2YgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZixcclxuICAgICAgICAgICAgY2xhc3MydHlwZTogYW55ID0ge1xyXG4gICAgICAgICAgICAgICAgXCJbb2JqZWN0IEJvb2xlYW5dXCI6IFwiYm9vbGVhblwiLFxyXG4gICAgICAgICAgICAgICAgXCJbb2JqZWN0IE51bWJlcl1cIjogXCJudW1iZXJcIixcclxuICAgICAgICAgICAgICAgIFwiW29iamVjdCBTdHJpbmddXCI6IFwic3RyaW5nXCIsXHJcbiAgICAgICAgICAgICAgICBcIltvYmplY3QgRnVuY3Rpb25dXCI6IFwiZnVuY3Rpb25cIixcclxuICAgICAgICAgICAgICAgIFwiW29iamVjdCBBcnJheV1cIjogXCJhcnJheVwiLFxyXG4gICAgICAgICAgICAgICAgXCJbb2JqZWN0IERhdGVdXCI6IFwiZGF0ZVwiLFxyXG4gICAgICAgICAgICAgICAgXCJbb2JqZWN0IFJlZ0V4cF1cIjogXCJyZWdleHBcIixcclxuICAgICAgICAgICAgICAgIFwiW29iamVjdCBPYmplY3RdXCI6IFwib2JqZWN0XCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgalF1ZXJ5OiBhbnkgPSB7XHJcbiAgICAgICAgICAgICAgICBpc0Z1bmN0aW9uOiBmdW5jdGlvbiAob2JqOiBhbnkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4galF1ZXJ5LnR5cGUob2JqKSA9PT0gXCJmdW5jdGlvblwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgaXNBcnJheTogQXJyYXkuaXNBcnJheSB8fFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKG9iajogYW55KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS50eXBlKG9iaikgPT09IFwiYXJyYXlcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGlzV2luZG93OiBmdW5jdGlvbiAob2JqOiBhbnkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqICE9IG51bGwgJiYgb2JqID09IG9iai53aW5kb3dcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBpc051bWVyaWM6IGZ1bmN0aW9uIChvYmo6IGFueSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhaXNOYU4ocGFyc2VGbG9hdChvYmopKSAmJiBpc0Zpbml0ZShvYmopXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iajogYW55KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iaiA9PSBudWxsID8gU3RyaW5nKG9iaikgOiBjbGFzczJ0eXBlW3RvU3RyaW5nLmNhbGwob2JqKV0gfHwgXCJvYmplY3RcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGlzUGxhaW5PYmplY3Q6IGZ1bmN0aW9uIChvYmo6IGFueSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghb2JqIHx8IGpRdWVyeS50eXBlKG9iaikgIT09IFwib2JqZWN0XCIgfHwgb2JqLm5vZGVUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqLmNvbnN0cnVjdG9yICYmICFoYXNPd24uY2FsbChvYmosIFwiY29uc3RydWN0b3JcIikgJiYgIWhhc093bi5jYWxsKG9iai5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsIFwiaXNQcm90b3R5cGVPZlwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoa2V5IGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2V5ID09PSB1bmRlZmluZWQgfHwgaGFzT3duLmNhbGwob2JqLCBrZXkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0YXJnZXQgPT09IFwiYm9vbGVhblwiKSB7XHJcbiAgICAgICAgICAgIGRlZXAgPSB0YXJnZXQ7XHJcbiAgICAgICAgICAgIHRhcmdldCA9IGFyZ3VtZW50c1sxXSB8fCB7fTtcclxuICAgICAgICAgICAgaSA9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgdGFyZ2V0ICE9PSBcIm9iamVjdFwiICYmICFqUXVlcnkuaXNGdW5jdGlvbih0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgIHRhcmdldCA9IHt9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChsZW5ndGggPT09IGkpIHtcclxuICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcztcclxuICAgICAgICAgICAgLS1pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGk7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoKG9wdGlvbnMgPSBhcmd1bWVudHNbaV0pICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGZvciAobmFtZSBpbiBvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3JjID0gdGFyZ2V0W25hbWVdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvcHkgPSBvcHRpb25zW25hbWVdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IGNvcHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlZXAgJiYgY29weSAmJiAoalF1ZXJ5LmlzUGxhaW5PYmplY3QoY29weSkgfHwgKGNvcHlJc0FycmF5ID0galF1ZXJ5LmlzQXJyYXkoY29weSkpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29weUlzQXJyYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcHlJc0FycmF5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNBcnJheShzcmMpID8gc3JjIDogW11cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb25lID0gc3JjICYmIGpRdWVyeS5pc1BsYWluT2JqZWN0KHNyYykgPyBzcmMgOiB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXQVJOSU5HOiBSRUNVUlNJT05cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0W25hbWVdID0gUG9ydHJhaXRUb29sLmV4dGVuZChkZWVwLCBjbG9uZSwgY29weSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3B5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0W25hbWVdID0gY29weTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldFVVSUQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkgKiAxNiB8IDAsIHYgPSBjID09ICd4JyA/IHIgOiAociAmIDB4MyB8IDB4OCk7XHJcbiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqICDlsIbliJfooajkuK3nmoQg5LiN5ZCM5oyH5a6a57G75Z6L77yIY3VycmVudFR5cGXvvInnmoTlrZDoioLngrnlvZLnu5PliLAg6Jma5ouf5paw5a2Q6IqC54K55LitXHJcbiAgICAgKiBAdGltZTogMjAxNy0wOC0yMyAxNToxOTo1MFxyXG4gICAgICogQHBhcmFtczogY3VycmVudFR5cGXvvJpzdHJpbmcg5oyH5a6a57G75Z6LXHJcbiAgICAgKiBAcGFyYW1zOiBtdWx0aXBsZURhdGFMaXN077yaQXJyYXk8QXJyYXk8YW55PiDmlbDmja7mupDvvIwg6buY6K6k56ys5LiA5Liq5pWw57uE5ZCr5pyJY3VycmVudFR5cGXnsbvlnovoioLngrlcclxuICAgICAqIEBwYXJhbXM6IG5ld0NoaWxkTmFtZe+8mnN0cmluZyAg5paw6Jma5ouf5a2Q6IqC54K55ZCN56ewIOi/veWKoOWQjeensOWtl+espuS4slxyXG4gICAgICogQHBhcmFtczogbmFtZUtlee+8mnN0cmluZyAg5paw6Jma5ouf5a2Q6IqC54K55ZCN56ewIOWxnuaAp+WQjVxyXG4gICAgICogQHBhcmFtczogaWRLZXlOYW1l77yac3RyaW5nICAg5qCR5qCH6K+GIGlkIOWxnuaApyDlkI1cclxuICAgICAqIEBwYXJhbXM6IHBpZEtleU5hbWXvvJpzdHJpbmcgICDmoJHniLbnuqfmoIfor4bniLZpZCAg5bGe5oCnIOWQjVxyXG4gICAgICogQHBhcmFtczogdHJlZVR5cGVLZXnvvJpzdHJpbmcgIOagkeexu+WeiyDlsZ7mgKcg5ZCNXHJcbiAgICAgKiBAcmV0dXJuOlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY2xhc3NpZnlEaWZmQ2hpbGQocGFyYW1zOiBDbGFzc2lmeURpZmZDaGlsZFBhcmFtcywgbXVsdGlwbGVEYXRhTGlzdDogQXJyYXk8QXJyYXk8YW55Pj4pOiBBcnJheTxhbnk+IHtcclxuICAgICAgICBsZXQgaWRBZGRTdHIgPSBcIitcIjtcclxuICAgICAgICBsZXQgc2VsZk5hbWUgPSBcIu+8iFwiICsgKCEhcGFyYW1zLm5ld0NoaWxkTmFtZSA/IHBhcmFtcy5uZXdDaGlsZE5hbWUgOiBcIuacrOWMuuWfn1wiKSArIFwi77yJXCI7XHJcbiAgICAgICAgbGV0IGRlZmF1bHRQYXJhbXMgPSB7XHJcbiAgICAgICAgICAgIG5ld0NoaWxkTmFtZVN0cjogc2VsZk5hbWUsXHJcbiAgICAgICAgICAgIG5hbWVLZXlTdHI6ICEhcGFyYW1zLm5hbWVLZXkgPyBwYXJhbXMubmFtZUtleSA6IFwiTmFtZVwiLFxyXG4gICAgICAgICAgICB0cmVlSWRLZXk6ICEhcGFyYW1zLmlkS2V5TmFtZSA/IHBhcmFtcy5pZEtleU5hbWUgOiBcInRyZWVJRFwiLFxyXG4gICAgICAgICAgICB0cmVlUGlkS2V5OiAhIXBhcmFtcy5waWRLZXlOYW1lID8gcGFyYW1zLnBpZEtleU5hbWUgOiBcInRyZWVQYXJlbnRJZFwiLFxyXG4gICAgICAgICAgICB0cmVlVHlwZUtleTogISFwYXJhbXMudHJlZVR5cGVLZXkgPyBwYXJhbXMudHJlZVR5cGVLZXkgOiBcInRyZWVUeXBlXCIsXHJcbiAgICAgICAgICAgIGN1cnJlbnRUeXBlOiAhIXBhcmFtcy5jdXJyZW50VHlwZSA/IHBhcmFtcy5jdXJyZW50VHlwZSA6IFRyZWVUeXBlLmFyZWEudmFsdWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiJWMgY2xhc3NpZnlEaWZmQ2hpbGQg5Y+C5pWw5pWw5o2uPT09PT09PT09PT1cIixcImNvbG9yOmdyZWVuXCIpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGRlZmF1bHRQYXJhbXMpO1xyXG5cclxuICAgICAgICAvLyDovazmlrDlop7oioLngrlcclxuICAgICAgICBsZXQgY29udmVydEFkZE5vZGUgPSAobm9kZURhdGE6IGFueSwgbmV3Q2hpbGROYW1lOiBzdHJpbmcsIG5ld0NoaWxkS2V5OiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgbGV0IG5hbWVLZXk6IHN0cmluZyA9IGRlZmF1bHRQYXJhbXMubmFtZUtleVN0cjtcclxuICAgICAgICAgICAgbGV0IG5ld05vZGUgPSBhbmd1bGFyLmNvcHkobm9kZURhdGEpO1xyXG4gICAgICAgICAgICBuZXdOb2RlW25hbWVLZXldID0gbmV3Q2hpbGROYW1lICsgbmV3Tm9kZVtuYW1lS2V5XTtcclxuICAgICAgICAgICAgbmV3Tm9kZVtkZWZhdWx0UGFyYW1zLnRyZWVQaWRLZXldID0gbm9kZURhdGFbZGVmYXVsdFBhcmFtcy50cmVlSWRLZXldO1xyXG4gICAgICAgICAgICBuZXdOb2RlW2RlZmF1bHRQYXJhbXMudHJlZUlkS2V5XSA9IGlkQWRkU3RyICsgbm9kZURhdGFbZGVmYXVsdFBhcmFtcy50cmVlSWRLZXldO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3Tm9kZTtcclxuXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgbGV0IG1haW5UeXBlTm9kZXMgPSBbXSBhcyBBcnJheTxhbnk+LFxyXG4gICAgICAgICAgICBtYWluVHlwZU5vZGVzTWFwID0ge30gYXMgeyBba2V5OiBzdHJpbmddOiBhbnkgfSxcclxuICAgICAgICAgICAgYWRkTm9kZXMgPSBbXSBhcyBBcnJheTxhbnk+LFxyXG4gICAgICAgICAgICBkaWZmTm9kZXMgPSBbXSBhcyBBcnJheTxhbnk+O1xyXG4gICAgICAgIC8vIOe7vOWQiCDliJfooajliIbnsbtcclxuICAgICAgICBhbmd1bGFyLmZvckVhY2gobXVsdGlwbGVEYXRhTGlzdFswXSwgKHZhbDogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodmFsW2RlZmF1bHRQYXJhbXMudHJlZVR5cGVLZXldID09PSBkZWZhdWx0UGFyYW1zLmN1cnJlbnRUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICBtYWluVHlwZU5vZGVzTWFwW3ZhbFtkZWZhdWx0UGFyYW1zLnRyZWVJZEtleV1dID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgbWFpblR5cGVOb2Rlcy5wdXNoKHZhbCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkaWZmTm9kZXMucHVzaCh2YWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2cobWFpblR5cGVOb2Rlcyk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coZGlmZk5vZGVzKTtcclxuICAgICAgICAvLyDpnZ7nu7zlkIjoioLngrkg5pWw57uE6L+e5o6lXHJcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKG11bHRpcGxlRGF0YUxpc3QsICh2YWw6IEFycmF5PGFueT4sIGk6IG51bWJlcikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaSA+IDAgJiYgYW5ndWxhci5pc0FycmF5KHZhbCkpIHtcclxuICAgICAgICAgICAgICAgIGRpZmZOb2RlcyA9IGRpZmZOb2Rlcy5jb25jYXQodmFsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKG1haW5UeXBlTm9kZXMpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGRpZmZOb2Rlcyk7XHJcbiAgICAgICAgbGV0IGFkZE5vZGU6IGFueSA9IG51bGw7XHJcbiAgICAgICAgbGV0IGFkZE5vZGVNYXAgPSB7fSBhcyB7IFtrZXk6IHN0cmluZ106IGJvb2xlYW4gfTtcclxuICAgICAgICBhbmd1bGFyLmZvckVhY2goZGlmZk5vZGVzLCAodmFsOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9KSA9PiB7XHJcbiAgICAgICAgICAgIGFkZE5vZGUgPSBtYWluVHlwZU5vZGVzTWFwW3ZhbFtkZWZhdWx0UGFyYW1zLnRyZWVQaWRLZXldXTtcclxuICAgICAgICAgICAgaWYgKHZhbFtkZWZhdWx0UGFyYW1zLnRyZWVQaWRLZXldICYmIGFkZE5vZGUgJiYgKHZhbFtkZWZhdWx0UGFyYW1zLnRyZWVUeXBlS2V5XSAhPT0gZGVmYXVsdFBhcmFtcy5jdXJyZW50VHlwZSkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghYWRkTm9kZU1hcFt2YWxbZGVmYXVsdFBhcmFtcy50cmVlUGlkS2V5XV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGROb2RlTWFwW3ZhbFtkZWZhdWx0UGFyYW1zLnRyZWVQaWRLZXldXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRkTm9kZSA9IGNvbnZlcnRBZGROb2RlKGFkZE5vZGUsIGRlZmF1bHRQYXJhbXMubmV3Q2hpbGROYW1lU3RyLCBkZWZhdWx0UGFyYW1zLm5hbWVLZXlTdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFkZE5vZGVzLnB1c2goYWRkTm9kZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhbFtkZWZhdWx0UGFyYW1zLnRyZWVQaWRLZXldID0gaWRBZGRTdHIgKyB2YWxbZGVmYXVsdFBhcmFtcy50cmVlUGlkS2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiJWMgY2xhc3NpZnlEaWZmQ2hpbGQg6L2s5o2i5ZCO5pWw5o2u77yMZGVmYXVsdFBhcmFtc++8jG1haW5UeXBlTm9kZXPvvIxkaWZmTm9kZXMg77yMYWRkTm9kZXM9PT09PT09PT09PVwiLFwiY29sb3I6Z3JlZW5cIik7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coZGVmYXVsdFBhcmFtcyk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2cobWFpblR5cGVOb2Rlcyk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coZGlmZk5vZGVzKTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhhZGROb2Rlcyk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCIlYyBjbGFzc2lmeURpZmZDaGlsZCDovazmjaLlkI7mlbDmja7vvIxkZWZhdWx0UGFyYW1z77yMbWFpblR5cGVOb2Rlc++8jGRpZmZOb2RlcyDvvIxhZGROb2Rlcz09PT09PT09PT09XCIsXCJjb2xvcjpncmVlblwiKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGFkZE5vZGVzLmNvbmNhdChtYWluVHlwZU5vZGVzLCBkaWZmTm9kZXMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxcXHJcbiAgICAgKiAg5qC55o2u6Iux5paH5qih5Z2X5ZCN5ou/5Yiw5Lit5paH5qih5Z2X5ZCNXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBnZXRDaGluZXNlTW9kdWxlTmFtZShtb2R1bGVOYW1lOnN0cmluZyl7XHJcbiAgICAgICAgbGV0IEZpdHN0TW9kdWxlOmFueSA9IGFuZ3VsYXIuY29weShPcGVyRml0c3RNb2R1bGUpO1xyXG4gICAgICAgIGxldCBTZWNvbmRNb2R1bGU6YW55ID0gYW5ndWxhci5jb3B5KE9wZXJTZWNvbmRNb2R1bGUpO1xyXG4gICAgICAgIGxldCBUaGlyZE1vZHVsZTphbnkgPSBhbmd1bGFyLmNvcHkoT3BlclRoaXJkTW9kdWxlKTtcclxuICAgICAgICBpZihGaXRzdE1vZHVsZVttb2R1bGVOYW1lXSl7XHJcbiAgICAgICAgICAgIHJldHVybiBGaXRzdE1vZHVsZVttb2R1bGVOYW1lXS5uYW1lXHJcbiAgICAgICAgfWVsc2UgaWYoU2Vjb25kTW9kdWxlW21vZHVsZU5hbWVdKXtcclxuICAgICAgICAgICAgcmV0dXJuIFNlY29uZE1vZHVsZVttb2R1bGVOYW1lXS5uYW1lXHJcbiAgICAgICAgfWVsc2UgaWYoVGhpcmRNb2R1bGVbbW9kdWxlTmFtZV0pe1xyXG4gICAgICAgICAgICByZXR1cm4gVGhpcmRNb2R1bGVbbW9kdWxlTmFtZV0ubmFtZVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn07XHJcblxyXG5leHBvcnQgY2xhc3MgQ2xhc3NpZnlEaWZmQ2hpbGRQYXJhbXMge1xyXG4gICAgY3VycmVudFR5cGU6IHN0cmluZztcclxuICAgIG5ld0NoaWxkTmFtZTogc3RyaW5nO1xyXG4gICAgbmFtZUtleTogc3RyaW5nO1xyXG4gICAgaWRLZXlOYW1lOiBzdHJpbmc7XHJcbiAgICBwaWRLZXlOYW1lOiBzdHJpbmc7XHJcbiAgICB0cmVlVHlwZUtleTogc3RyaW5nO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudFR5cGUgPSBUcmVlVHlwZS5hcmVhLnZhbHVlO1xyXG4gICAgICAgIHRoaXMubmV3Q2hpbGROYW1lID0gXCLvvIjmnKzpg6jvvIlcIjtcclxuICAgICAgICB0aGlzLm5hbWVLZXkgPSBcIk5hbWVcIjtcclxuICAgICAgICB0aGlzLmlkS2V5TmFtZSA9IFwidHJlZUlEXCI7XHJcbiAgICAgICAgdGhpcy5waWRLZXlOYW1lID0gXCJ0cmVlUGFyZW50SWRcIjtcclxuICAgICAgICB0aGlzLnRyZWVUeXBlS2V5ID0gXCJ0cmVlVHlwZVwiO1xyXG4gICAgfVxyXG59XHJcblxyXG4iXX0=
