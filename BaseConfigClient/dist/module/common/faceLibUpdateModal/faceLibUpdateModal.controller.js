define(["require", "exports", "../../common/app/main.app", "../../common/directive/tree/tree-params", "../../../core/entity/BusinessLib", "../../../core/entity/Area", "../../../core/entity/ex/BusinessLibEx", "../portrait-tool", "../system-config", "angular", "../../common/services/area.service", "../../common/services/businessLib.service", "../../../core/entity/ex/BusinessLibEx", "./faceLibUpdateModal.factory", "../factory/userinfo.cache.factory", "../factory/layerMsg.factory"], function (require, exports, main_app_1, tree_params_1, BusinessLib_1, Area_1, BusinessLibEx_1, portrait_tool_1, system_config_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var FaceLibUpdateModalController = (function () {
        function FaceLibUpdateModalController($scope, $timeout, layerDec, i18nFactory, userInfoCacheFactory, faceLibUpdateModalFactory, areaService, businessLibService) {
            var _this = this;
            this.$scope = $scope;
            this.$timeout = $timeout;
            this.layerDec = layerDec;
            this.i18nFactory = i18nFactory;
            this.userInfoCacheFactory = userInfoCacheFactory;
            this.faceLibUpdateModalFactory = faceLibUpdateModalFactory;
            this.areaService = areaService;
            this.businessLibService = businessLibService;
            this.isUpdate = false;
            this.initUpdateModelParams();
            $scope.$on("$destroy", function () {
                _this.faceLibUpdateModalFactory.setUpdateParams(null);
            });
            this.getAreaTree();
        }
        FaceLibUpdateModalController.prototype.initUpdateModelParams = function () {
            this.initTreeParams();
            var modelParams = this.faceLibUpdateModalFactory.getUpdateParams();
            this.currentServe = new BusinessLibEx_1.BusinessLibEx();
            this.currentServe.AreaModel = new Area_1.Area();
            (!!modelParams.updateModalData) && (this.currentServe = modelParams.updateModalData);
            this.currentServe.ParentName = modelParams.parentName;
            this.currentServe.ParentID = modelParams.parentID;
            this.isUpdate = modelParams.isUpdate;
            this.closeModelEmitName = modelParams.modalClosedWatchName;
            (!!modelParams.parentID) && (this.areaTreeDatas.defaultSelectTreeId = modelParams.parentID);
            this.areaTreeDatas.isDefaultSelected = true;
        };
        ;
        FaceLibUpdateModalController.prototype.initTreeParams = function () {
            var _this = this;
            this.areaTreeDatas = new tree_params_1.TreeDataParams(true);
            this.areaTreeDatas.treeId = 'updateFaceLibModalTree';
            this.areaTreeDatas.treeInitComplete = function (treeId) {
            };
            this.areaTreeDatas.onClick = function (event, treeId, treeNode) {
                _this.$timeout(function () {
                    _this.setTreeSelectData(treeNode);
                    _this.currentServe.ParentName = treeNode.Name;
                });
            };
        };
        ;
        FaceLibUpdateModalController.prototype.setTreeSelectData = function (treeData) {
            if (treeData.AreaID) {
                this.currentServe.AreaID = treeData.AreaID;
                this.currentServe.ParentID = treeData.ID;
                this.currentServe.ParentModel = new BusinessLib_1.BusinessLib();
                this.currentServe.ParentModel = treeData;
            }
            else {
                this.currentServe.AreaID = treeData.ID;
                this.currentServe.ParentID = null;
                this.currentServe.ParentModel = new Area_1.Area();
                this.currentServe.ParentModel.Name = treeData.Name;
            }
        };
        ;
        FaceLibUpdateModalController.prototype.commitSaveOrUpdate = function () {
            var _this = this;
            if (!this.validateParams(this.currentServe)) {
                return;
            }
            var reqParams = angular.copy(this.currentServe);
            reqParams.ParentModel = null;
            if (reqParams.ID) {
                console.log("=========更新===============");
                this.businessLibService.update(reqParams).then(function (resp) {
                    if (resp.code == 200) {
                        _this.closeUpdateModel(true, false, _this.currentServe);
                    }
                });
            }
            else {
                console.log("===========新加=============");
                reqParams.Creator = this.userInfoCacheFactory.getCurrentUserId();
                this.businessLibService.save(reqParams).then(function (resp) {
                    if (resp.code == 200) {
                        _this.currentServe.ID = resp.data;
                        _this.closeUpdateModel(true, true, _this.currentServe);
                    }
                });
            }
        };
        ;
        FaceLibUpdateModalController.prototype.closeUpdateModel = function (isCommit, isAdd, modelData) {
            var _this = this;
            if (isCommit) {
                this.$timeout(function () {
                    _this.$scope.$emit(_this.closeModelEmitName, { isCommit: isCommit, isAdd: isAdd, modelData: modelData });
                }, 500);
            }
            else {
                this.$scope.$emit(this.closeModelEmitName, { isCommit: isCommit, isAdd: isAdd, modelData: modelData });
            }
        };
        FaceLibUpdateModalController.prototype.getAreaTree = function (keyword) {
            var _this = this;
            var reqParams = {
                keyword: ''
            };
            if (keyword) {
                reqParams.keyword = keyword;
            }
            var self_this = this;
            this.businessLibService.findTreeWithArea().then(function (resp) {
                if (resp && resp.code && resp.data) {
                    var params = new portrait_tool_1.ClassifyDiffChildParams();
                    params.newChildName = _this.i18nFactory("FDS_00_12_35");
                    var nodeData = portrait_tool_1.default.classifyDiffChild(params, [resp.data]);
                    self_this.setModalAreaTree(nodeData);
                }
                console.error(resp.data);
            });
        };
        FaceLibUpdateModalController.prototype.changeIsShowAreaTree = function () {
            this.areaTreeDatas.isShow = !this.areaTreeDatas.isShow;
        };
        ;
        FaceLibUpdateModalController.prototype.setModalAreaTree = function (data) {
            this.areaTreeDatas.treeDatas = data;
        };
        FaceLibUpdateModalController.prototype.validateParams = function (model) {
            if (!model.AreaID) {
                this.layerDec.warnInfo(this.i18nFactory("FDS_01_06_23"));
                return false;
            }
            if (model.ID && this.currentServe.ParentModel) {
                if (this.currentServe.ParentModel.ID === model.ID || this.currentServe.ParentModel.ParentID === model.ID) {
                    this.layerDec.warnInfo(this.i18nFactory("FDS_00_04_04"));
                    return false;
                }
                if (this.currentServe.ParentModel.ID === system_config_1.SystemConfig.CONST_LIB) {
                    this.layerDec.warnInfo(this.i18nFactory("FDS_01_06_26", { value: this.currentServe.ParentModel.Name }));
                    return false;
                }
            }
            return true;
        };
        FaceLibUpdateModalController.$inject = ['$scope', '$timeout',
            'layerDec', 'i18nFactory',
            'userInfoCacheFactory', 'faceLibUpdateModalFactory', 'areaService', 'businessLibService'];
        return FaceLibUpdateModalController;
    }());
    main_app_1.app
        .controller('faceLibUpdateModalController', FaceLibUpdateModalController);
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tb2R1bGUvY29tbW9uL2ZhY2VMaWJVcGRhdGVNb2RhbC9mYWNlTGliVXBkYXRlTW9kYWwuY29udHJvbGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7SUFpQ0E7UUFZSSxzQ0FBb0IsTUFBVyxFQUFVLFFBQWEsRUFDMUMsUUFBbUIsRUFBVSxXQUFnQixFQUM3QyxvQkFBMkMsRUFDM0MseUJBQXFELEVBQ3JELFdBQXlCLEVBQVUsa0JBQXVDO1lBSnRGLGlCQVVDO1lBVm1CLFdBQU0sR0FBTixNQUFNLENBQUs7WUFBVSxhQUFRLEdBQVIsUUFBUSxDQUFLO1lBQzFDLGFBQVEsR0FBUixRQUFRLENBQVc7WUFBVSxnQkFBVyxHQUFYLFdBQVcsQ0FBSztZQUM3Qyx5QkFBb0IsR0FBcEIsb0JBQW9CLENBQXVCO1lBQzNDLDhCQUF5QixHQUF6Qix5QkFBeUIsQ0FBNEI7WUFDckQsZ0JBQVcsR0FBWCxXQUFXLENBQWM7WUFBVSx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQXFCO1lBZnRGLGFBQVEsR0FBWSxLQUFLLENBQUM7WUFnQnRCLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1lBQzdCLE1BQU0sQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFO2dCQUNuQixLQUFJLENBQUMseUJBQXlCLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3pELENBQUMsQ0FBQyxDQUFDO1lBQ0gsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ3ZCLENBQUM7UUFFRCw0REFBcUIsR0FBckI7WUFDSSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDdEIsSUFBSSxXQUFXLEdBQUcsSUFBSSxDQUFDLHlCQUF5QixDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQ25FLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSw2QkFBYSxFQUFFLENBQUM7WUFDeEMsSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLEdBQUcsSUFBSSxXQUFJLEVBQUUsQ0FBQztZQUN6QyxDQUFDLENB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QyxXQUFXLENBQUMsRUFBRSxLQUFLLDRCQUFZLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztvQkFDOUQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxjQUFjLEVBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO29CQUN4RyxNQUFNLENBQUMsS0FBSyxDQUFDO2dCQUNqQixDQUFDO1lBQ0wsQ0FBQztZQUNELE1BQU0sQ0FBQyxJQUFJLENBQUM7UUFDaEIsQ0FBQztRQWxKTSxvQ0FBTyxHQUFHLENBQUMsUUFBUSxFQUFFLFVBQVU7WUFDbEMsVUFBVSxFQUFFLGFBQWE7WUFDekIsc0JBQXNCLEVBQUUsMkJBQTJCLEVBQUUsYUFBYSxFQUFFLG9CQUFvQixDQUFDLENBQUM7UUFpSmxHLG1DQUFDO0tBM0pELEFBMkpDLElBQUE7SUFDRCxjQUFHO1NBQ0UsVUFBVSxDQUFDLDhCQUE4QixFQUFFLDRCQUE0QixDQUFDLENBQUMiLCJmaWxlIjoibW9kdWxlL2NvbW1vbi9mYWNlTGliVXBkYXRlTW9kYWwvZmFjZUxpYlVwZGF0ZU1vZGFsLmNvbnRyb2xsZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IHsgYXBwIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9hcHAvbWFpbi5hcHBcIjtcclxuaW1wb3J0ICdhbmd1bGFyJztcclxuaW1wb3J0ICcuLi8uLi9jb21tb24vc2VydmljZXMvYXJlYS5zZXJ2aWNlJztcclxuaW1wb3J0IFwiLi4vLi4vY29tbW9uL3NlcnZpY2VzL2J1c2luZXNzTGliLnNlcnZpY2VcIjtcclxuXHJcbmltcG9ydCB7IElUcmVlRGF0YVBhcmFtcywgVHJlZURhdGFQYXJhbXMgfSBmcm9tIFwiLi4vLi4vY29tbW9uL2RpcmVjdGl2ZS90cmVlL3RyZWUtcGFyYW1zXCI7XHJcblxyXG5pbXBvcnQgeyBJQnVzaW5lc3NMaWJTZXJ2aWNlIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9zZXJ2aWNlcy9idXNpbmVzc0xpYi5zZXJ2aWNlXCI7XHJcblxyXG5pbXBvcnQgeyBBcmVhRXggfSBmcm9tIFwiLi4vLi4vLi4vY29yZS9lbnRpdHkvZXgvQXJlYUV4XCI7XHJcbmltcG9ydCB7IEJ1c2luZXNzTGliIH0gZnJvbSBcIi4uLy4uLy4uL2NvcmUvZW50aXR5L0J1c2luZXNzTGliXCI7XHJcbmltcG9ydCB7IEFyZWEgfSBmcm9tIFwiLi4vLi4vLi4vY29yZS9lbnRpdHkvQXJlYVwiO1xyXG5pbXBvcnQgeyBSZXNwb25zZVJlc3VsdCB9IGZyb20gXCIuLi8uLi8uLi9jb3JlL3BhcmFtcy9yZXN1bHQvUmVzcG9uc2VSZXN1bHRcIjtcclxuaW1wb3J0IHsgSUFyZWFTZXJ2aWNlIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9zZXJ2aWNlcy9hcmVhLnNlcnZpY2VcIjtcclxuXHJcbmltcG9ydCBcIi4uLy4uLy4uL2NvcmUvZW50aXR5L2V4L0J1c2luZXNzTGliRXhcIjtcclxuaW1wb3J0IHsgQnVzaW5lc3NMaWJFeCB9IGZyb20gXCIuLi8uLi8uLi9jb3JlL2VudGl0eS9leC9CdXNpbmVzc0xpYkV4XCI7XHJcblxyXG5pbXBvcnQgXCIuL2ZhY2VMaWJVcGRhdGVNb2RhbC5mYWN0b3J5XCI7XHJcbmltcG9ydCB7IElGYWNlTGliVXBkYXRlTW9kYWxGYWN0b3J5IH0gZnJvbSBcIi4vZmFjZUxpYlVwZGF0ZU1vZGFsLmZhY3RvcnlcIjtcclxuaW1wb3J0IFwiLi4vZmFjdG9yeS91c2VyaW5mby5jYWNoZS5mYWN0b3J5XCI7XHJcbmltcG9ydCB7IElVc2VySW5mb0NhY2hlRmFjdG9yeSB9IGZyb20gXCIuLi9mYWN0b3J5L3VzZXJpbmZvLmNhY2hlLmZhY3RvcnlcIjtcclxuaW1wb3J0IHsgQ2xhc3NpZnlEaWZmQ2hpbGRQYXJhbXMsIGRlZmF1bHQgYXMgUG9ydHJhaXRUb29sIH0gZnJvbSBcIi4uL3BvcnRyYWl0LXRvb2xcIjtcclxuXHJcbmltcG9ydCBcIi4uL2ZhY3RvcnkvbGF5ZXJNc2cuZmFjdG9yeVwiO1xyXG5pbXBvcnQgeyBJTGF5ZXJEZWMgfSBmcm9tIFwiLi4vZmFjdG9yeS9sYXllck1zZy5mYWN0b3J5XCI7XHJcbmltcG9ydCB7IFN5c3RlbUNvbmZpZyB9IGZyb20gXCIuLi9zeXN0ZW0tY29uZmlnXCI7XHJcblxyXG5kZWNsYXJlIGxldCBhbmd1bGFyOiBhbnk7XHJcblxyXG50eXBlIEFyZWFCdXNpbmVzc0xpYkV4ID0gQXJlYUV4ICYgQnVzaW5lc3NMaWJFeDtcclxuXHJcbmNsYXNzIEZhY2VMaWJVcGRhdGVNb2RhbENvbnRyb2xsZXIge1xyXG4gICAgaXNVcGRhdGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGN1cnJlbnRTZXJ2ZTogQnVzaW5lc3NMaWJFeDtcclxuXHJcbiAgICAvLy0tLS0tLS1zdGFydC0tLS3moJEg57uT5p6EIOaOp+S7tiDlj4LmlbBcclxuICAgIGFyZWFUcmVlRGF0YXM6IElUcmVlRGF0YVBhcmFtczxBcmVhRXg+O1xyXG4gICAgY2xvc2VNb2RlbEVtaXROYW1lOiBzdHJpbmc7XHJcbiAgICAvLy0tLS0tLS1lbmRcclxuICAgIHN0YXRpYyAkaW5qZWN0ID0gWyckc2NvcGUnLCAnJHRpbWVvdXQnLFxyXG4gICAgICAgICdsYXllckRlYycsICdpMThuRmFjdG9yeScsXHJcbiAgICAgICAgJ3VzZXJJbmZvQ2FjaGVGYWN0b3J5JywgJ2ZhY2VMaWJVcGRhdGVNb2RhbEZhY3RvcnknLCAnYXJlYVNlcnZpY2UnLCAnYnVzaW5lc3NMaWJTZXJ2aWNlJ107XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSAkc2NvcGU6IGFueSwgcHJpdmF0ZSAkdGltZW91dDogYW55LFxyXG4gICAgICAgIHByaXZhdGUgbGF5ZXJEZWM6IElMYXllckRlYywgcHJpdmF0ZSBpMThuRmFjdG9yeTogYW55LFxyXG4gICAgICAgIHByaXZhdGUgdXNlckluZm9DYWNoZUZhY3Rvcnk6IElVc2VySW5mb0NhY2hlRmFjdG9yeSxcclxuICAgICAgICBwcml2YXRlIGZhY2VMaWJVcGRhdGVNb2RhbEZhY3Rvcnk6IElGYWNlTGliVXBkYXRlTW9kYWxGYWN0b3J5LFxyXG4gICAgICAgIHByaXZhdGUgYXJlYVNlcnZpY2U6IElBcmVhU2VydmljZSwgcHJpdmF0ZSBidXNpbmVzc0xpYlNlcnZpY2U6IElCdXNpbmVzc0xpYlNlcnZpY2UpIHtcclxuICAgICAgICB0aGlzLmluaXRVcGRhdGVNb2RlbFBhcmFtcygpO1xyXG4gICAgICAgICRzY29wZS4kb24oXCIkZGVzdHJveVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZmFjZUxpYlVwZGF0ZU1vZGFsRmFjdG9yeS5zZXRVcGRhdGVQYXJhbXMobnVsbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5nZXRBcmVhVHJlZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXRVcGRhdGVNb2RlbFBhcmFtcygpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmluaXRUcmVlUGFyYW1zKCk7XHJcbiAgICAgICAgbGV0IG1vZGVsUGFyYW1zID0gdGhpcy5mYWNlTGliVXBkYXRlTW9kYWxGYWN0b3J5LmdldFVwZGF0ZVBhcmFtcygpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFNlcnZlID0gbmV3IEJ1c2luZXNzTGliRXgoKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTZXJ2ZS5BcmVhTW9kZWwgPSBuZXcgQXJlYSgpO1xyXG4gICAgICAgICghIW1vZGVsUGFyYW1zLnVwZGF0ZU1vZGFsRGF0YSkgJiYgKHRoaXMuY3VycmVudFNlcnZlID0gbW9kZWxQYXJhbXMudXBkYXRlTW9kYWxEYXRhKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTZXJ2ZS5QYXJlbnROYW1lID0gbW9kZWxQYXJhbXMucGFyZW50TmFtZTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTZXJ2ZS5QYXJlbnRJRCA9IG1vZGVsUGFyYW1zLnBhcmVudElEO1xyXG5cclxuICAgICAgICB0aGlzLmlzVXBkYXRlID0gbW9kZWxQYXJhbXMuaXNVcGRhdGU7XHJcblxyXG4gICAgICAgIHRoaXMuY2xvc2VNb2RlbEVtaXROYW1lID0gbW9kZWxQYXJhbXMubW9kYWxDbG9zZWRXYXRjaE5hbWU7XHJcblxyXG4gICAgICAgICghIW1vZGVsUGFyYW1zLnBhcmVudElEKSAmJiAodGhpcy5hcmVhVHJlZURhdGFzLmRlZmF1bHRTZWxlY3RUcmVlSWQgPSBtb2RlbFBhcmFtcy5wYXJlbnRJRCk7XHJcblxyXG4gICAgICAgIHRoaXMuYXJlYVRyZWVEYXRhcy5pc0RlZmF1bHRTZWxlY3RlZCA9IHRydWU7XHJcbiAgICB9O1xyXG4gICAgLy/moJHnu5PmnoTlj4LmlbDliJ3lp4vljJZcclxuICAgIGluaXRUcmVlUGFyYW1zKCkge1xyXG4gICAgICAgIHRoaXMuYXJlYVRyZWVEYXRhcyA9IG5ldyBUcmVlRGF0YVBhcmFtczxBcmVhQnVzaW5lc3NMaWJFeD4odHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5hcmVhVHJlZURhdGFzLnRyZWVJZCA9ICd1cGRhdGVGYWNlTGliTW9kYWxUcmVlJztcclxuICAgICAgICB0aGlzLmFyZWFUcmVlRGF0YXMudHJlZUluaXRDb21wbGV0ZSA9ICh0cmVlSWQ6IHN0cmluZykgPT4ge1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hcmVhVHJlZURhdGFzLm9uQ2xpY2sgPSAoZXZlbnQ6IE1vdXNlRXZlbnQsIHRyZWVJZDogc3RyaW5nLCB0cmVlTm9kZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuJHRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUcmVlU2VsZWN0RGF0YSh0cmVlTm9kZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTZXJ2ZS5QYXJlbnROYW1lID0gdHJlZU5vZGUuTmFtZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgc2V0VHJlZVNlbGVjdERhdGEodHJlZURhdGE6IEJ1c2luZXNzTGliKSB7XHJcbiAgICAgICAgaWYgKHRyZWVEYXRhLkFyZWFJRCkge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTZXJ2ZS5BcmVhSUQgPSB0cmVlRGF0YS5BcmVhSUQ7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNlcnZlLlBhcmVudElEID0gdHJlZURhdGEuSUQ7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTZXJ2ZS5QYXJlbnRNb2RlbCA9IG5ldyBCdXNpbmVzc0xpYigpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTZXJ2ZS5QYXJlbnRNb2RlbCA9IHRyZWVEYXRhO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNlcnZlLkFyZWFJRCA9IHRyZWVEYXRhLklEO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTZXJ2ZS5QYXJlbnRJRCA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTZXJ2ZS5QYXJlbnRNb2RlbCA9IG5ldyBBcmVhKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNlcnZlLlBhcmVudE1vZGVsLk5hbWUgPSB0cmVlRGF0YS5OYW1lO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgY29tbWl0U2F2ZU9yVXBkYXRlKCkge1xyXG4gICAgICAgIGlmICghdGhpcy52YWxpZGF0ZVBhcmFtcyh0aGlzLmN1cnJlbnRTZXJ2ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgcmVxUGFyYW1zID0gYW5ndWxhci5jb3B5KHRoaXMuY3VycmVudFNlcnZlKTtcclxuICAgICAgICByZXFQYXJhbXMuUGFyZW50TW9kZWwgPSBudWxsO1xyXG4gICAgICAgIGlmIChyZXFQYXJhbXMuSUQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCI9PT09PT09PT3mm7TmlrA9PT09PT09PT09PT09PT1cIik7XHJcbiAgICAgICAgICAgIHRoaXMuYnVzaW5lc3NMaWJTZXJ2aWNlLnVwZGF0ZShyZXFQYXJhbXMpLnRoZW4oKHJlc3A6IFJlc3BvbnNlUmVzdWx0PHN0cmluZz4pID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNwLmNvZGUgPT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZVVwZGF0ZU1vZGVsKHRydWUsIGZhbHNlLCB0aGlzLmN1cnJlbnRTZXJ2ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiPT09PT09PT09PT3mlrDliqA9PT09PT09PT09PT09XCIpO1xyXG4gICAgICAgICAgICByZXFQYXJhbXMuQ3JlYXRvciA9IHRoaXMudXNlckluZm9DYWNoZUZhY3RvcnkuZ2V0Q3VycmVudFVzZXJJZCgpO1xyXG4gICAgICAgICAgICB0aGlzLmJ1c2luZXNzTGliU2VydmljZS5zYXZlKHJlcVBhcmFtcykudGhlbigocmVzcDogUmVzcG9uc2VSZXN1bHQ8c3RyaW5nPikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3AuY29kZSA9PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTZXJ2ZS5JRCA9IHJlc3AuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlVXBkYXRlTW9kZWwodHJ1ZSwgdHJ1ZSwgdGhpcy5jdXJyZW50U2VydmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY2xvc2VVcGRhdGVNb2RlbChpc0NvbW1pdDogYm9vbGVhbiwgaXNBZGQ6IGJvb2xlYW4sIG1vZGVsRGF0YTogQnVzaW5lc3NMaWJFeCkge1xyXG4gICAgICAgIGlmIChpc0NvbW1pdCkge1xyXG4gICAgICAgICAgICAvKlRPRE8g5oiQ5Yqf6K+35rGCIOWQjuW7tui/nyA1MDAg5L+d6K+B5YiX6KGo5pWw5o2u5ZCM5q2lKi9cclxuICAgICAgICAgICAgdGhpcy4kdGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLiRzY29wZS4kZW1pdCh0aGlzLmNsb3NlTW9kZWxFbWl0TmFtZSwgeyBpc0NvbW1pdDogaXNDb21taXQsIGlzQWRkOiBpc0FkZCwgbW9kZWxEYXRhOiBtb2RlbERhdGEgfSk7XHJcbiAgICAgICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy4kc2NvcGUuJGVtaXQodGhpcy5jbG9zZU1vZGVsRW1pdE5hbWUsIHsgaXNDb21taXQ6IGlzQ29tbWl0LCBpc0FkZDogaXNBZGQsIG1vZGVsRGF0YTogbW9kZWxEYXRhIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vLS0tLS0tLS0tLS0tIGFyZWFUcmVlIGRhdGFcclxuICAgIGdldEFyZWFUcmVlKGtleXdvcmQ/OiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgcmVxUGFyYW1zID0ge1xyXG4gICAgICAgICAgICBrZXl3b3JkOiAnJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKGtleXdvcmQpIHtcclxuICAgICAgICAgICAgcmVxUGFyYW1zLmtleXdvcmQgPSBrZXl3b3JkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgc2VsZl90aGlzID0gdGhpcztcclxuXHJcbiAgICAgICAgdGhpcy5idXNpbmVzc0xpYlNlcnZpY2UuZmluZFRyZWVXaXRoQXJlYSgpLnRoZW4oKHJlc3A6IFJlc3BvbnNlUmVzdWx0PEFycmF5PEFyZWFCdXNpbmVzc0xpYkV4Pj4pID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlc3AgJiYgcmVzcC5jb2RlICYmIHJlc3AuZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgLy9zZWxmX3RoaXMuc2V0TW9kYWxBcmVhVHJlZShyZXNwLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBhcmFtcyA9IG5ldyBDbGFzc2lmeURpZmZDaGlsZFBhcmFtcygpO1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLm5ld0NoaWxkTmFtZSA9IHRoaXMuaTE4bkZhY3RvcnkoXCJGRFNfMDBfMTJfMzVcIik7XHJcbiAgICAgICAgICAgICAgICBsZXQgbm9kZURhdGEgPSBQb3J0cmFpdFRvb2wuY2xhc3NpZnlEaWZmQ2hpbGQocGFyYW1zLCBbcmVzcC5kYXRhXSk7XHJcbiAgICAgICAgICAgICAgICBzZWxmX3RoaXMuc2V0TW9kYWxBcmVhVHJlZShub2RlRGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihyZXNwLmRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOaUueWPmOaYvuekuiBhcmVhVHJlZVxyXG4gICAgY2hhbmdlSXNTaG93QXJlYVRyZWUoKSB7XHJcbiAgICAgICAgdGhpcy5hcmVhVHJlZURhdGFzLmlzU2hvdyA9ICF0aGlzLmFyZWFUcmVlRGF0YXMuaXNTaG93O1xyXG4gICAgfTtcclxuICAgIC8vLS0tLS0tLS0tLS0tIGFyZWFUcmVlIGRhdGFcclxuICAgIHNldE1vZGFsQXJlYVRyZWUoZGF0YTogQXJyYXk8QXJlYUJ1c2luZXNzTGliRXg+KSB7XHJcbiAgICAgICAgdGhpcy5hcmVhVHJlZURhdGFzLnRyZWVEYXRhcyA9IGRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgLy/pqozor4HlrZfmrrXpmZDliLbvvIzov5Tlm57mj5DnpLror61cclxuICAgIHZhbGlkYXRlUGFyYW1zKG1vZGVsOiBCdXNpbmVzc0xpYkV4KTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKCFtb2RlbC5BcmVhSUQpIHtcclxuICAgICAgICAgICAgdGhpcy5sYXllckRlYy53YXJuSW5mbyh0aGlzLmkxOG5GYWN0b3J5KFwiRkRTXzAxXzA2XzIzXCIpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG1vZGVsLklEICYmIHRoaXMuY3VycmVudFNlcnZlLlBhcmVudE1vZGVsKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTZXJ2ZS5QYXJlbnRNb2RlbC5JRCA9PT0gbW9kZWwuSUQgfHwgdGhpcy5jdXJyZW50U2VydmUuUGFyZW50TW9kZWwuUGFyZW50SUQgPT09IG1vZGVsLklEKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxheWVyRGVjLndhcm5JbmZvKHRoaXMuaTE4bkZhY3RvcnkoXCJGRFNfMDBfMDRfMDRcIikpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTZXJ2ZS5QYXJlbnRNb2RlbC5JRCA9PT0gU3lzdGVtQ29uZmlnLkNPTlNUX0xJQikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXllckRlYy53YXJuSW5mbyh0aGlzLmkxOG5GYWN0b3J5KFwiRkRTXzAxXzA2XzI2XCIsIHsgdmFsdWU6IHRoaXMuY3VycmVudFNlcnZlLlBhcmVudE1vZGVsLk5hbWUgfSkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG59XHJcbmFwcFxyXG4gICAgLmNvbnRyb2xsZXIoJ2ZhY2VMaWJVcGRhdGVNb2RhbENvbnRyb2xsZXInLCBGYWNlTGliVXBkYXRlTW9kYWxDb250cm9sbGVyKTsiXX0=
