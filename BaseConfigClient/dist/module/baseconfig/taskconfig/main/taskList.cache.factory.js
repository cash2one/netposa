define(["require", "exports", "../../../common/app/main.app", "../../../../core/server/enum/TaskStatus", "../../../../core/server/enum/AuditStatus"], function (require, exports, main_app_1, TaskStatus_1, AuditStatus_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var FindCacheByPageParams = (function () {
        function FindCacheByPageParams() {
            this.currentPage = 1;
            this.pageSize = 10;
            this.totalCount = 0;
            this.pageCount = 1;
        }
        return FindCacheByPageParams;
    }());
    exports.FindCacheByPageParams = FindCacheByPageParams;
    var TaskTypes = (function () {
        function TaskTypes() {
            this.Face = { value: 'Car', text: '车辆' };
            this.Car = { value: 'Face', text: '人脸' };
            this.Mac = { value: 'Mac', text: 'Mac' };
        }
        return TaskTypes;
    }());
    exports.TaskTypes = TaskTypes;
    var TaskListCacheFactory = (function () {
        function TaskListCacheFactory() {
            var _this = this;
            this.TaskTypes = new TaskTypes();
            this.getTaskTotal = function (type) {
                if (type === _this.TaskTypes.Face.value) {
                    return _this.taskFaceList.length;
                }
                else if (type === _this.TaskTypes.Mac.value) {
                    return _this.taskMacList.length;
                }
                else if (type === _this.TaskTypes.Car.value) {
                    return _this.taskCarList.length;
                }
            };
        }
        TaskListCacheFactory.prototype.setTaskList = function (srcList, type) {
            var _this = this;
            switch (type) {
                case this.TaskTypes.Face.value:
                    this.taskFaceList = [];
                    this.taskListFaceMap = {};
                    this.taskFaceList = srcList;
                    angular.forEach(this.taskFaceList, function (val) {
                        _this.taskListFaceMap[val.ID] = val;
                    });
                    break;
                case this.TaskTypes.Mac.value:
                    this.taskMacList = [];
                    this.taskListMacMap = {};
                    this.taskMacList = srcList;
                    angular.forEach(this.taskMacList, function (val) {
                        _this.taskListMacMap[val.ID] = val;
                    });
                    break;
                case this.TaskTypes.Car.value:
                    this.taskCarList = [];
                    this.taskListCarMap = {};
                    this.taskCarList = srcList;
                    angular.forEach(this.taskCarList, function (val) {
                        _this.taskListCarMap[val.ID] = val;
                    });
                    break;
                default:
                    return;
            }
        };
        ;
        TaskListCacheFactory.prototype.updateFaceAuditStatus = function (ids, auditStatusValue) {
            var _this = this;
            if (ids && ids.length > 0) {
                var taskItem_1 = null;
                angular.forEach(ids, function (val) {
                    if (_this.taskListFaceMap[val]) {
                        taskItem_1 = _this.taskListFaceMap[val];
                        taskItem_1.AuditStatus = auditStatusValue;
                        if (auditStatusValue === AuditStatus_1.AuditStatus.Verified.value) {
                            taskItem_1.Status = TaskStatus_1.TaskStatus.Run.value;
                        }
                    }
                });
                return true;
            }
            return false;
        };
        ;
        TaskListCacheFactory.prototype.updateFaceRunStatus = function (ids, isStart) {
            var _this = this;
            if (ids && ids.length > 0) {
                var taskItem_2 = null;
                angular.forEach(ids, function (val) {
                    taskItem_2 = _this.taskListFaceMap[val];
                    if (isStart) {
                        taskItem_2.Status = TaskStatus_1.TaskStatus.Run.value;
                    }
                    else {
                        taskItem_2.Status = TaskStatus_1.TaskStatus.Stop.value;
                    }
                });
                return true;
            }
            else {
                return false;
            }
        };
        ;
        TaskListCacheFactory.prototype.deleteByFaceIds = function (ids) {
            var _this = this;
            if (ids && ids.length > 0) {
                var i_1, len_1;
                angular.forEach(ids, function (val) {
                    i_1 = 0;
                    len_1 = _this.taskFaceList.length;
                    for (; i_1 < len_1; i_1++) {
                        if (_this.taskFaceList[i_1].ID === val) {
                            _this.taskFaceList.splice(i_1, 1);
                            break;
                        }
                    }
                });
                angular.forEach(this.taskFaceList, function (val) {
                    _this.taskListFaceMap[val.ID] = val;
                });
                return true;
            }
            return false;
        };
        ;
        TaskListCacheFactory.prototype.getListByPage = function (params, type) {
            if (params.pageSize < this.getTaskTotal(type)) {
                var startIndex = params.pageSize * (params.currentPage - 1);
                var endIndex = params.pageSize * params.currentPage;
                if (type === this.TaskTypes.Face.value) {
                    return angular.copy(this.taskFaceList.slice(startIndex, endIndex));
                }
                else if (type === this.TaskTypes.Mac.value) {
                    return angular.copy(this.taskMacList.slice(startIndex, endIndex));
                }
                else if (type === this.TaskTypes.Car.value) {
                    return angular.copy(this.taskCarList.slice(startIndex, endIndex));
                }
            }
            else {
                if (type === this.TaskTypes.Face.value) {
                    return angular.copy(this.taskFaceList);
                }
                else if (type === this.TaskTypes.Mac.value) {
                    return angular.copy(this.taskMacList);
                }
                else if (type === this.TaskTypes.Car.value) {
                    return angular.copy(this.taskCarList);
                }
            }
        };
        ;
        return TaskListCacheFactory;
    }());
    main_app_1.app
        .service('taskListCacheFactory', TaskListCacheFactory);
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tb2R1bGUvYmFzZWNvbmZpZy90YXNrY29uZmlnL21haW4vdGFza0xpc3QuY2FjaGUuZmFjdG9yeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7SUFjQTtRQUFBO1lBQ0ksZ0JBQVcsR0FBVyxDQUFDLENBQUM7WUFDeEIsYUFBUSxHQUFXLEVBQUUsQ0FBQztZQUN0QixlQUFVLEdBQVcsQ0FBQyxDQUFDO1lBQ3ZCLGNBQVMsR0FBVyxDQUFDLENBQUM7UUFDMUIsQ0FBQztRQUFELDRCQUFDO0lBQUQsQ0FMQSxBQUtDLElBQUE7SUFMWSxzREFBcUI7SUFPbEM7UUFBQTtZQUNJLFNBQUksR0FBUyxFQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBQyxDQUFDO1lBQ3hDLFFBQUcsR0FBUyxFQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBQyxDQUFDO1lBQ3hDLFFBQUcsR0FBUyxFQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBQyxDQUFDO1FBQzVDLENBQUM7UUFBRCxnQkFBQztJQUFELENBSkEsQUFJQyxJQUFBO0lBSlksOEJBQVM7SUFnQ3RCO1FBQUE7WUFBQSxpQkE4SUM7WUE3SVcsY0FBUyxHQUFjLElBQUksU0FBUyxFQUFFLENBQUM7WUFrSS9DLGlCQUFZLEdBQUcsVUFBQyxJQUFZO2dCQUN4QixFQUFFLENBQUMsQ0FBQyxJQUFJLEtBQUssS0FBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztvQkFDckMsTUFBTSxDQUFDLEtBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDO2dCQUNwQyxDQUFDO2dCQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLEtBQUssS0FBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztvQkFDM0MsTUFBTSxDQUFDLEtBQUksQ0FBQyxXQUFXLENB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QUMsQ0FBQyxJQUFJLEtBQUssSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztvQkFDM0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO2dCQUMxQyxDQUFDO1lBRUwsQ0FBQztRQUdMLENBQUM7UUFBQSxDQUFDO1FBYU4sMkJBQUM7SUFBRCxDQTlJQSxBQThJQyxJQUFBO0lBRUQsY0FBRztTQUNFLE9BQU8sQ0FBQyxzQkFBc0IsRUFBRSxvQkFBb0IsQ0FBQyxDQUFDIiwiZmlsZSI6Im1vZHVsZS9iYXNlY29uZmlnL3Rhc2tjb25maWcvbWFpbi90YXNrTGlzdC5jYWNoZS5mYWN0b3J5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIGNyZWF0ZSBieSB6eHFcclxuICogIOS7u+WKoeWIl+ihqCDnvJPlrZjmnKzlnLDmk43kvZxcclxuICogQHRpbWU6IDIwMTctMDYtMTYgMTc6NDc6NThcclxuICovXHJcbmltcG9ydCB7YXBwfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwcC9tYWluLmFwcFwiO1xyXG5pbXBvcnQge1Rhc2tNb2RlbH0gZnJvbSBcIi4uLy4uLy4uLy4uL2NvcmUvc2VydmVyL1Rhc2tNb2RlbFwiO1xyXG5pbXBvcnQge1Rhc2tTdGF0dXN9IGZyb20gXCIuLi8uLi8uLi8uLi9jb3JlL3NlcnZlci9lbnVtL1Rhc2tTdGF0dXNcIjtcclxuaW1wb3J0IHtBdWRpdFN0YXR1c30gZnJvbSBcIi4uLy4uLy4uLy4uL2NvcmUvc2VydmVyL2VudW0vQXVkaXRTdGF0dXNcIjtcclxuaW1wb3J0IHtFbnVtfSBmcm9tICcuLi8uLi8uLi8uLi9jb3JlL2VudW0vRW51bSc7XHJcbmltcG9ydCB7TWFjTW9uaXRvciwgQ2FyTW9uaXRvcn0gZnJvbSBcIi4uLy4uLy4uLy4uL2NvcmUvc2VydmVyL1Rhc2tNb2RlbFwiO1xyXG5cclxuZGVjbGFyZSBsZXQgYW5ndWxhcjogYW55O1xyXG5kZWNsYXJlIGxldCB3aW5kb3c6IGFueTtcclxuXHJcbmV4cG9ydCBjbGFzcyBGaW5kQ2FjaGVCeVBhZ2VQYXJhbXMge1xyXG4gICAgY3VycmVudFBhZ2U6IG51bWJlciA9IDE7IC8vIOmhteeggeaVsFxyXG4gICAgcGFnZVNpemU6IG51bWJlciA9IDEwOyAvLyDljZXpobXlpKflsI9cclxuICAgIHRvdGFsQ291bnQ6IG51bWJlciA9IDA7IC8vIOaAu+aVsOaNruadoeaVsCjpnIDopoHpmaTku6VwYWdlU2l6Zei9rOaNouS4uumhteaVsClcclxuICAgIHBhZ2VDb3VudDogbnVtYmVyID0gMTsgLy8g5oC76aG15pWwXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBUYXNrVHlwZXMge1xyXG4gICAgRmFjZTogRW51bSA9IHt2YWx1ZTogJ0NhcicsIHRleHQ6ICfovabovoYnfTtcclxuICAgIENhcjogRW51bSA9IHt2YWx1ZTogJ0ZhY2UnLCB0ZXh0OiAn5Lq66IS4J307XHJcbiAgICBNYWM6IEVudW0gPSB7dmFsdWU6ICdNYWMnLCB0ZXh0OiAnTWFjJ307XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVRhc2tMaXN0Q2FjaGVGYWN0b3J5IHtcclxuICAgIC8vXHJcbiAgICBzZXRUYXNrTGlzdDogKHNyY0xpc3Q6IEFycmF5PFRhc2tNb2RlbCAmIE1hY01vbml0b3IgJiBDYXJNb25pdG9yPiwgdHlwZTogc3RyaW5nKSA9PiB2b2lkO1xyXG4gICAgLy8g5pu05pS55Lu75Yqh5a6h5qC454q25oCBXHJcbiAgICB1cGRhdGVGYWNlQXVkaXRTdGF0dXM6IChpZHM6IEFycmF5PHN0cmluZz4sIGF1ZGl0U3RhdHVzVmFsdWU6IHN0cmluZykgPT4gYm9vbGVhbjtcclxuXHJcbiAgICBkZWxldGVCeUZhY2VJZHM6IChpZHM6IEFycmF5PHN0cmluZz4pID0+IGJvb2xlYW47XHJcbiAgICAvKiogY3JlYXRlIGJ5IHp4cVxyXG4gICAgICogIOWIhumhteiOt+WPliDnvJPlrZjmnKzlnLDmlbDmja5cclxuICAgICAqIEB0aW1lOiAyMDE3LTA2LTE3IDE4OjExOjQ0XHJcbiAgICAgKiBAcGFyYW1zOiBGaW5kQ2FjaGVCeVBhZ2VQYXJhbXNcclxuICAgICAqIEByZXR1cm46IEFycmF5PFRhc2tNb2RlbD5cclxuICAgICAqL1xyXG4gICAgZ2V0TGlzdEJ5UGFnZTogKHBhcmFtczogRmluZENhY2hlQnlQYWdlUGFyYW1zLCB0eXBlOiBzdHJpbmcpID0+IEFycmF5PFRhc2tNb2RlbCAmIE1hY01vbml0b3IgJiBDYXJNb25pdG9yPjtcclxuICAgIC8vLyDojrflj5bmnKzlnLDmlbDmja7mnaHnm67mgLvmlbBcclxuICAgIGdldFRhc2tUb3RhbDogKHR5cGU6IHN0cmluZykgPT4gbnVtYmVyO1xyXG4gICAgLyoqIGNyZWF0ZSBieSB6eHFcclxuICAgICAqICDmm7TmlrDmnKzlnLAg5Lu75Yqh5YiX6KGoIOi/kOihjOeKtuaAgVxyXG4gICAgICogQHRpbWU6IDIwMTctMDYtMTcgMTg6MDk6NTRcclxuICAgICAqIEBwYXJhbXM6IGlkcyA6IElEIOe7k+WQiCDvvJtcclxuICAgICAqIEBwYXJhbXM6IGlzU3RhcnQgOiAg5piv5ZCm5byA5ZCvIHRydWUg5byA5ZCv77yMZmFsc2Ug5pqC5YGcXHJcbiAgICAgKiBAcmV0dXJuOiBib29sZWFuIOaTjeS9nOe7k+aenFxyXG4gICAgICovXHJcbiAgICB1cGRhdGVGYWNlUnVuU3RhdHVzOiAoaWRzOiBBcnJheTxzdHJpbmc+LCBpc1N0YXJ0OiBib29sZWFuKSA9PiBib29sZWFuO1xyXG59XHJcblxyXG5jbGFzcyBUYXNrTGlzdENhY2hlRmFjdG9yeSBpbXBsZW1lbnRzIElUYXNrTGlzdENhY2hlRmFjdG9yeSB7XHJcbiAgICBwcml2YXRlIFRhc2tUeXBlczogVGFza1R5cGVzID0gbmV3IFRhc2tUeXBlcygpO1xyXG4gICAgcHJpdmF0ZSB0YXNrRmFjZUxpc3Q6IEFycmF5PFRhc2tNb2RlbD47XHJcbiAgICBwcml2YXRlIHRhc2tNYWNMaXN0OiBBcnJheTxNYWNNb25pdG9yPjtcclxuICAgIHByaXZhdGUgdGFza0Nhckxpc3Q6IEFycmF5PENhck1vbml0b3I+O1xyXG5cclxuXHJcbiAgICBwcml2YXRlIHRhc2tMaXN0RmFjZU1hcDogeyBba2V5OiBzdHJpbmddOiBUYXNrTW9kZWwgfTtcclxuICAgIHByaXZhdGUgdGFza0xpc3RNYWNNYXA6IHsgW2tleTogc3RyaW5nXTogTWFjTW9uaXRvciB9O1xyXG4gICAgcHJpdmF0ZSB0YXNrTGlzdENhck1hcDogeyBba2V5OiBzdHJpbmddOiBDYXJNb25pdG9yIH07XHJcblxyXG4gICAgc2V0VGFza0xpc3Qoc3JjTGlzdDogQXJyYXk8VGFza01vZGVsICYgTWFjTW9uaXRvciAmIENhck1vbml0b3I+LCB0eXBlOiBzdHJpbmcpIHtcclxuXHJcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgdGhpcy5UYXNrVHlwZXMuRmFjZS52YWx1ZSA6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRhc2tGYWNlTGlzdCA9IFtdIGFzIEFycmF5PFRhc2tNb2RlbD47XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy50YXNrTGlzdEZhY2VNYXAgPSB7fSBhcyB7IFtrZXk6IHN0cmluZ106IFRhc2tNb2RlbCB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YXNrRmFjZUxpc3QgPSBzcmNMaXN0O1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHRoaXMudGFza0ZhY2VMaXN0LCAodmFsOiBUYXNrTW9kZWwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tMaXN0RmFjZU1hcFt2YWwuSURdID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSB0aGlzLlRhc2tUeXBlcy5NYWMudmFsdWUgOlxyXG4gICAgICAgICAgICAgICAgdGhpcy50YXNrTWFjTGlzdCA9IFtdIGFzIEFycmF5PE1hY01vbml0b3I+O1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YXNrTGlzdE1hY01hcCA9IHt9IGFzIHsgW2tleTogc3RyaW5nXTogTWFjTW9uaXRvciB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YXNrTWFjTGlzdCA9IHNyY0xpc3QgYXMgQXJyYXk8TWFjTW9uaXRvcj47XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2godGhpcy50YXNrTWFjTGlzdCwgKHZhbDogTWFjTW9uaXRvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGFza0xpc3RNYWNNYXBbdmFsLklEXSA9IHZhbDtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSB0aGlzLlRhc2tUeXBlcy5DYXIudmFsdWUgOlxyXG4gICAgICAgICAgICAgICAgdGhpcy50YXNrQ2FyTGlzdCA9IFtdIGFzIEFycmF5PENhck1vbml0b3I+O1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YXNrTGlzdENhck1hcCA9IHt9IGFzIHsgW2tleTogc3RyaW5nXTogQ2FyTW9uaXRvciB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YXNrQ2FyTGlzdCA9IHNyY0xpc3QgYXMgQXJyYXk8Q2FyTW9uaXRvcj47XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2godGhpcy50YXNrQ2FyTGlzdCwgKHZhbDogQ2FyTW9uaXRvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGFza0xpc3RDYXJNYXBbdmFsLklEXSA9IHZhbDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIOabtOaUueS7u+WKoeWuoeaguOeKtuaAgSA9PlxyXG4gICAgdXBkYXRlRmFjZUF1ZGl0U3RhdHVzKGlkczogQXJyYXk8c3RyaW5nPiwgYXVkaXRTdGF0dXNWYWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKGlkcyAmJiBpZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBsZXQgdGFza0l0ZW0gPSBudWxsO1xyXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goaWRzLCAodmFsOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRhc2tMaXN0RmFjZU1hcFt2YWxdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFza0l0ZW0gPSB0aGlzLnRhc2tMaXN0RmFjZU1hcFt2YWxdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhc2tJdGVtLkF1ZGl0U3RhdHVzID0gYXVkaXRTdGF0dXNWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAvL+WuoeaguOmAmui/h+WQjum7mOiupOW8gOWQr+eKtuaAgVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhdWRpdFN0YXR1c1ZhbHVlID09PSBBdWRpdFN0YXR1cy5WZXJpZmllZC52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrSXRlbS5TdGF0dXMgPSBUYXNrU3RhdHVzLlJ1bi52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuXHJcbiAgICB1cGRhdGVGYWNlUnVuU3RhdHVzKGlkczogQXJyYXk8c3RyaW5nPiwgaXNTdGFydDogYm9vbGVhbik6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmIChpZHMgJiYgaWRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbGV0IHRhc2tJdGVtID0gbnVsbDtcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGlkcywgKHZhbDogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0YXNrSXRlbSA9IHRoaXMudGFza0xpc3RGYWNlTWFwW3ZhbF07XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNTdGFydCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhc2tJdGVtLlN0YXR1cyA9IFRhc2tTdGF0dXMuUnVuLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0YXNrSXRlbS5TdGF0dXMgPSBUYXNrU3RhdHVzLlN0b3AudmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBkZWxldGVCeUZhY2VJZHMoaWRzOiBBcnJheTxzdHJpbmc+KTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKGlkcyAmJiBpZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBsZXQgaTogbnVtYmVyLCBsZW46IG51bWJlcjtcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGlkcywgKHZhbDogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpID0gMDtcclxuICAgICAgICAgICAgICAgIGxlbiA9IHRoaXMudGFza0ZhY2VMaXN0Lmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50YXNrRmFjZUxpc3RbaV0uSUQgPT09IHZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tGYWNlTGlzdC5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2godGhpcy50YXNrRmFjZUxpc3QsICh2YWw6IFRhc2tNb2RlbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YXNrTGlzdEZhY2VNYXBbdmFsLklEXSA9IHZhbDtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuXHJcbiAgICBnZXRMaXN0QnlQYWdlKHBhcmFtczogRmluZENhY2hlQnlQYWdlUGFyYW1zLCB0eXBlOiBzdHJpbmcpOiBBcnJheTxUYXNrTW9kZWwgJiBNYWNNb25pdG9yICYgQ2FyTW9uaXRvcj4ge1xyXG4gICAgICAgIGlmIChwYXJhbXMucGFnZVNpemUgPCB0aGlzLmdldFRhc2tUb3RhbCh0eXBlKSkge1xyXG4gICAgICAgICAgICBsZXQgc3RhcnRJbmRleDogbnVtYmVyID0gcGFyYW1zLnBhZ2VTaXplICogKHBhcmFtcy5jdXJyZW50UGFnZSAtIDEpO1xyXG4gICAgICAgICAgICBsZXQgZW5kSW5kZXg6IG51bWJlciA9IHBhcmFtcy5wYWdlU2l6ZSAqIHBhcmFtcy5jdXJyZW50UGFnZTtcclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IHRoaXMuVGFza1R5cGVzLkZhY2UudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmNvcHkodGhpcy50YXNrRmFjZUxpc3Quc2xpY2Uoc3RhcnRJbmRleCwgZW5kSW5kZXgpKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSB0aGlzLlRhc2tUeXBlcy5NYWMudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmNvcHkodGhpcy50YXNrTWFjTGlzdC5zbGljZShzdGFydEluZGV4LCBlbmRJbmRleCkpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IHRoaXMuVGFza1R5cGVzLkNhci52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuY29weSh0aGlzLnRhc2tDYXJMaXN0LnNsaWNlKHN0YXJ0SW5kZXgsIGVuZEluZGV4KSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IHRoaXMuVGFza1R5cGVzLkZhY2UudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmNvcHkodGhpcy50YXNrRmFjZUxpc3QpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IHRoaXMuVGFza1R5cGVzLk1hYy52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuY29weSh0aGlzLnRhc2tNYWNMaXN0KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSB0aGlzLlRhc2tUeXBlcy5DYXIudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmNvcHkodGhpcy50YXNrQ2FyTGlzdCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9O1xyXG5cclxuICAgIGdldFRhc2tUb3RhbCA9ICh0eXBlOiBzdHJpbmcpOiBudW1iZXIgPT4ge1xyXG4gICAgICAgIGlmICh0eXBlID09PSB0aGlzLlRhc2tUeXBlcy5GYWNlLnZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhc2tGYWNlTGlzdC5sZW5ndGg7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSB0aGlzLlRhc2tUeXBlcy5NYWMudmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFza01hY0xpc3QubGVuZ3RoO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gdGhpcy5UYXNrVHlwZXMuQ2FyLnZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhc2tDYXJMaXN0Lmxlbmd0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgfTtcclxuXHJcbn1cclxuXHJcbmFwcFxyXG4gICAgLnNlcnZpY2UoJ3Rhc2tMaXN0Q2FjaGVGYWN0b3J5JywgVGFza0xpc3RDYWNoZUZhY3RvcnkpO1xyXG4iXX0=
